<clr-main-container>
    <clr-header class="header-6" *ngIf="showMainMenu">
        <div class="branding">
            <a href="http://clarityanalytics.xyz" class="nav-link">
                <span class="clr-icon ca-logo">
                <img src="../favicon.ico" height="35" width="35">
                </span>
                <span class="title">{{ companyName }}</span>
            </a>
        </div>

        <div class="header-nav" [clr-nav-level]="1">
            <div>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        Dashboard
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickDashboardNew()">
                            New
                        </button>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Recent
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem
                                    (click)="showRecentDashboard()">
                                    1. Budget per Department
                                </button>
                                <button type="button" clrDropdownItem>
                                    2. Economic Overview
                                </button>
                                <button type="button" clrDropdownItem>
                                    3. Leave Summary
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Open
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem
                                (click)="clickDashboardOpen()">
                                    Existing Dashboard
                                </button>
                                <button type="button" clrDropdownItem
                                (click)="clickDashboardImport()">
                                    Import
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button
                            type="button"
                            clrDropdownItem
                            (click)="clickDashboardEdit()"
                            title="Enable EditMode to make changes"
                            >
                            {{ editMenuText }}
                        </button>
                        <button type="button" clrDropdownItem (click)="clickDashboardRename()">
                            Rename
                        </button>
                        <button type="button" clrDropdownItem (click)="clickDashboardSave()">
                            Save
                        </button>
                        <button type="button" clrDropdownItem (click)="clickDashboardDiscard()">
                            Discard
                        </button>
                        <button type="button" clrDropdownItem (click)="clickDashboardShare()">
                            Share
                        </button>
                        <button type="button" clrDropdownItem (click)="clickDashboardSnapshots()">
                            Snapshots
                        </button>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Details
                            </button>
                            <clr-dropdown-menu clrPosition="right-bottom" *clrIfOpen>
                                <button type="button" clrDropdownItem
                                (click)="clickMenuDashboardDetailDescription()">
                                    Descripton
                                </button>
                                <button type="button" clrDropdownItem
                                    (click)="showFav=!showFav">
                                    Favourite
                                    <clr-icon
                                        shape="check"
                                        size="12"
                                        *ngIf="showFav">
                                    </clr-icon>
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailTags()"
                                    >
                                    Tags
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailSettings()"
                                    >
                                    Settings
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailComments()"
                                    >
                                    Comments
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailTheme()"
                                    >
                                    Theme
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailTemplate()"
                                    >
                                    Template
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardDetailSchedule()"
                                    >
                                    Schedule
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button type="button" clrDropdownItem
                        (click)="clickMenuDashboardPrint()">
                            Print
                        </button>

                        <button
                            type="button"
                            clrDropdownItem
                            (click)="clickMenuDashboardDelete()"
                            >
                            Delete
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        Data
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Recent
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem>
                                    1. Sales per region
                                </button>
                                <button type="button" clrDropdownItem>
                                    2. Risk analysis
                                </button>
                                <button type="button" clrDropdownItem>
                                    3. Part maintenance
                                </button>
                                <button type="button" clrDropdownItem>
                                    4. Production comparison
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuDataFromFile()">
                            From File
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuDataFromServer()">
                            From Server
                        </button>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Samples
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem>
                                    1. Personal Budget
                                </button>
                                <button type="button" clrDropdownItem>
                                    2. Voting by gender ...
                                </button>
                                <button type="button" clrDropdownItem>
                                    3. Aging populatio...
                                </button>
                                <button type="button" clrDropdownItem>
                                    4. Gold reserves ...
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                More ...
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem>
                                    Database
                                </button>
                                <button type="button" clrDropdownItem>
                                    Service
                                </button>
                                <button type="button" clrDropdownItem>
                                    Web
                                </button>
                                <button type="button" clrDropdownItem>
                                    NoSQL
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuDataCombinations()">
                            Combinations
                        </button>
                        <div class="dropdown-divider"></div>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Slicers
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" clrDropdownItem  (click)="clickMenuDataSlicerAdd()">
                                    Add Slicer
                                </button>
                                <button type="button" clrDropdownItem (click)="clickMenuDataSlicerEdit()">
                                    Edit Slicer
                                </button>
                                <div class="dropdown-divider" (click)="clickMenuDataSlicerDelete()"></div>
                                <button type="button" clrDropdownItem>
                                    Delete Slicer
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuDataShare()">
                            Share
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuDataRefreshAll()">
                            Refresh All
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        [disabled] = "!hasDatasources"
                        >
                        Widget
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetNew()">
                            New
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetEdit()">
                            Edit
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetCheckpoints()">
                            Checkpoints
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetComments()">
                            Comments
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetLinks()">
                            Links
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetRefresh()">
                            Refresh
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetDuplicate()">
                            Duplicate
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetExpand()">
                            Expand
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetExport()">
                            Export
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuWidgetDelete()">
                            Delete Widget
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        Edit
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuEditUndo()">
                            Undo
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuEditRedo()">
                            Redo
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuEditSelectAll()">
                            Select All
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuEditSelectNone()">
                            Select None
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        Shape
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuShapeNew()">
                            New
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuShapeEdit()">
                            Edit
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuShapeLinks()">
                            Links
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuShapeDelete()">
                            Delete
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        View
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuViewPresentation()">
                            Presention
                            <clr-icon shape="check" size="12" *ngIf="presentationMode"></clr-icon>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuViewPrintPreview()">
                            Print preview
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuDashboardTreeview()">
                            Treeview
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuViewShowGrid()">
                            Show grid
                            <clr-icon shape="check" size="12" *ngIf="showGrid"></clr-icon>
                        </button>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuViewSnapToGrid()">
                            Snap to Grid
                        </button>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Grid size
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item" clrDropdownItem>Small</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Medium</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Large</button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Zoom %
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item" clrDropdownItem>50%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>75%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>100%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>150%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>200%</button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button type="button" clrDropdownItem (click)="clickMenuViewZoom()">
                            Zoom 100%
                        </button>
                        <div class="dropdown-divider"></div>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        [disabled] = "!(hasDatasources  &&  editMode)"
                        >
                        Arrange
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeBackward()">
                            Backward
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeForward()">
                            Forward
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeBack()">
                            Back
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeFront()">
                            Front
                        </button>
                        <div class="dropdown-divider"></div>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                >
                                Align
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item" clrDropdownItem>Left</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Center</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Right</button>
                                <div class="dropdown-divider"></div>
                                <button type="button" class="dropdown-item" clrDropdownItem
                                    (click)="clickMenuArrangeAligTop()"
                                    >
                                    Top
                                </button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Middle</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Bottom</button>
                                <div class="dropdown-divider"></div>
                                <button type="button" clrDropdownItem (click)="clickMenuArrangeAlignCenterPageDown()">
                                    Center page
                                    <clr-icon shape="two-way-arrows down"></clr-icon>
                                </button>
                                <button type="button" clrDropdownItem (click)="clickMenuArrangeAlignCenterPageRight()">
                                    Center page
                                    <clr-icon shape="two-way-arrows right"></clr-icon>
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeGroup()">
                            Group
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeUnGroup()">
                            Ungroup
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeDistributeVertical()">
                            Distribute
                            <clr-icon shape="two-way-arrows"></clr-icon>
                        </button>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeDistributeHorisontal()">
                            Distribute
                            <clr-icon shape="two-way-arrows right"></clr-icon>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickMenuArrangeSameSize()">
                            Same size
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        >
                        Help
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button" clrDropdownItem (click)="clickMenuHelpDemo()">
                            Demo
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Getting starting with Canvas
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Getting data
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Creating a Dashboard
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Creating a Widget
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Transforming data
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Tutorials
                        </button>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Documentation
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button" clrDropdownItem (click)="clickSave()">
                            Support
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

            </div>
        </div>

        <div class="header-actions">
            <clr-dropdown class="dropdown">
                <button class="nav-icon" clrDropdownTrigger>
                <clr-icon shape="share"></clr-icon>
                <clr-icon shape="caret down"></clr-icon>
                </button>
                <clr-dropdown-menu clrPosition="bottom-right" *clrIfOpen>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateAlerts()">
                        Alerts
                    </button>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateMessages()">
                        Messages
                    </button>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateActivities()">
                        Activities
                    </button>
                    <div class="dropdown-divider"></div>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateAlert()">
                        Send Message
                    </button>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateAlert()">
                        Send Email
                    </button>
                    <button type="button" clrDropdownItem (click)="clickMenuCollaborateActivityAdd()">
                        Add Activity
                    </button>
                </clr-dropdown-menu>
            </clr-dropdown>

            <clr-dropdown class="dropdown">
                <button class="nav-icon" clrDropdownTrigger>
                <clr-icon shape="user" class="is-solid has-alert"></clr-icon>
                <clr-icon shape="caret down"></clr-icon>
                </button>
                <clr-dropdown-menu clrPosition="bottom-right" *clrIfOpen>
                    <a clrDropdownItem (click)="clickMenuUserLogin()">Login</a>
                    <a clrDropdownItem (click)="clickMenuUserMyProfile()">My Profile</a>
                    <a clrDropdownItem (click)="clickMenuUserPreferences()">Preferences</a>
                    <a clrDropdownItem (click)="clickMenuDashboardSubscribe()">Subscribe</a>
                    <a clrDropdownItem (click)="clickMenuUserWidgetButtonBar()">Widget Button Bar</a>
                    <a clrDropdownItem (click)="clickMenuUserShapeButtonBar()">Shape Button Bar</a>
                    <a clrDropdownItem (click)="clickMenuUserSystemSettings()">System Settings</a>
                    <a clrDropdownItem (click)="clickMenuUserOffline()">Work Offline</a>
                    <a clrDropdownItem (click)="clickMenuUserLogout()">Log out</a>
                </clr-dropdown-menu>
            </clr-dropdown>

        </div>
    </clr-header>

        <!-- Presentation Button -->
        <div class="presentationButton dropdown" *ngIf="presentationMode">
            <clr-dropdown>
                <button type="button" clrDropdownTrigger>
                    <clr-icon shape="bars"></clr-icon>
                </button>

                <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                    <button
                        type="button"
                        class="btn btn-link btn-sm"
                        clrDropdownItem
                        title="Show the first Dashboard in the presentation"
                        >
                        <clr-icon shape="step-forward down" size="20"></clr-icon>
                        First Dashboard
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary btn-sm"
                        clrDropdownItem
                        title="Jump to the Next Dashboard"
                        >
                        <clr-icon shape="fast-forward" size="20"></clr-icon>
                        Next Dashboard
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary btn-sm"
                        clrDropdownItem
                        title="Return to the Previous Dashboard"
                        >
                        <clr-icon shape="rewind" size="20"></clr-icon>
                        Previous Dashboard
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary btn-sm"
                        clrDropdownItem
                        title="Show the Last Dashboard in the presentation"
                        >
                        <clr-icon shape="step-forward" size="20"></clr-icon>
                        Last Dashboard
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary btn-sm"
                        clrDropdownItem
                        title="Print all the Dashboards in presentation format"
                        >
                        <clr-icon shape="printer" size="20"></clr-icon>
                        Print ...
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary btn-sm"
                        clrDropdownItem
                        (click)="clickClosePresentation()"
                        title="Exit the presentation, and return to the Dashboard page"
                        >
                        <clr-icon shape="times" size="20"></clr-icon>
                        Exit
                    </button>
                </clr-dropdown-menu>
            </clr-dropdown>
        </div>


    <div class="content-container"
        [style.background-image]="showGrid? 'url(../images/gridBlock.png)' : ''"
        >
        <div  class="content-area" >
            <router-outlet ></router-outlet>
        </div>
    </div>

    <!-- Status Bar -->
    <status-bar *ngIf="showMainMenu"
        [editMode]="editMode"
        [currentDashboardName]="currentDashboardName"
        [currentTabName]="currentTabName"
        [statusBarRunning]="statusBarRunning"
        [statusBarCancelRefresh]="statusBarCancelRefresh"
        [statusBarMessages]="statusBarMessages"
        [loggedIntoServerText]="loggedIntoServerText"
        [templateInUse]="templateInUse"
        >
    </status-bar>

</clr-main-container>


<!-- Modal: landing page -->
<landing *ngIf="showModalLanding"
    (formLandingClosed)="handleCloseModalLanding()">Load landing page ...
</landing>


<!-- Palette -->
<div class="palette" *ngIf="editMode  &&  !presentationMode">
    <clr-icon
        shape="pencil"
        size="20"
        class="buttonBarIcon"
        (click)="clickWidgetEdit(i)"
        title="Edit Widget"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode"
        shape="pop-out"
        size="20"
        class="buttonBarIcon"
        (click)="clickWidgetCheckpoints(i)"
        title="Show Checkpoints"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode"
        shape="note"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetComments(i)"
        title="Show Comments"
        >
    </clr-icon>
    <clr-icon
        shape="link"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetLinks(i)"
        title="Show Links"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode"
        shape="refresh"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetRefresh(i)"
        title="Refresh Dataset for this Widget only"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode  &&  hasDatasources"
        shape="copy"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetDuplicate(i)"
        title="Duplicate this Widget"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode"
        shape="pop-out"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetExpand(i)"
        title="Expand the Dataset for this Widget"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode"
        shape="export"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetExport(i)"
        title="Export the Dataset for this Widget"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode  &&  hasDatasources"
        shape="deploy"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuArrangeBack(i)"
        title="Move Widget back"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode  &&  hasDatasources"
        shape="block"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuArrangeFront(i)"
        title="Move Widget forward"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode  &&  hasDatasources"
        shape="trash"
        size="20"
        class="buttonBarIcon"
        (click)="clickMenuWidgetDelete(i)"
        title="Delete this Widget"
        >
    </clr-icon>
    <clr-icon *ngIf="!presentationMode  &&  hasDatasources"
        shape="cursor-arrow"
        size="20"
        class="buttonBarIcon"
        (click)="clickSelect(i)"
        title="Select this Widget"
        >
    </clr-icon>
</div>


<!-- Modal: new Dashboard -->
<dashboard-new
    class="formPopupDashboard"
    *ngIf="showModalDashboardNew"
    (formDashboardNewClosed)="handleCloseDashboardNew($event)">Load New Dashboard ...
</dashboard-new>


<!-- Modal: open Dashboard -->
<dashboard-open
    class="formPopupDashboard"
    *ngIf="showModalDashboardOpen"
    (formDashboardOpenClosed)="handleCloseDashboardOpen($event)">Load Open Dashboard ...
</dashboard-open>


<!-- Modal: save Dashboard -->
<dashboard-save
    class="formPopupDashboard"
    *ngIf="showModalDashboardSave"
    (formDashboardSaveClosed)="handleCloseDashboardSave($event)">Load Save Dashboard ...
</dashboard-save>


<!-- Modal: discard Dashboard -->
<dashboard-discard
    class="formPopupDashboard"
    *ngIf="showModalDashboardDiscard"
    (formDashboardDiscardClosed)="handleCloseDashboardDiscard($event)">Load Discard Dashboard ...
</dashboard-discard>


<!-- Modal: rename Dashboard -->
<dashboard-rename
    class="formPopupDashboard"
    *ngIf="showModalDashboardRename"
    (formDashboardRenameClosed)="handleCloseDashboardRename($event)">Load Rename Dashboard ...
</dashboard-rename>


<!-- Modal: Dashboard Details -->
<dashboard-details
    class="formPopupDashboard"
    *ngIf="showModalDashboardDetails"
    (formDashboardDetailsClosed)="handleCloseDashboardDetails($event)">Load Dashboard Details ...
</dashboard-details>


<!-- Modal: Dashboard Description -->
<dashboard-description
    class="formPopupDashboard"
    *ngIf="showModalDashboardDescription"
    (formDashboardDescriptionClosed)="handleCloseDashboardDescription($event)">Load Dashboard Description ...
</dashboard-description>


<!-- Modal: Snapshots -->
<dashboard-snapshots
    class="formPopupDashboard"
    *ngIf="showModalDashboardSnapshots"
    (formDashboardSnapshotsClosed)="handleCloseDashboardSnapshots($event)">Load Snapshots Dashboard ...
</dashboard-snapshots>


<!-- Modal: Share -->
<dashboard-share
    class="formPopupDashboard"
    *ngIf="showModalDashboardShare"
    (formDashboardShareClosed)="handleCloseDashboardShare($event)">Load Share Dashboard ...
</dashboard-share>


<!-- Modal: Import -->
<dashboard-import
    class="formPopupDashboard"
    *ngIf="showModalDashboardImport"
    (formDashboardImportClosed)="handleCloseDashboardImport($event)">Load Import Dashboard ...
</dashboard-import>


<!-- Modal: New Tab -->
<dashboard-tab
    class="formPopupDashboard"
    *ngIf="showNewTab"
    (formDashboardTabClosed)="handleCloseDashboardTab($event)">Load Dashboard Tab ...
</dashboard-tab>


<!-- Modal: Dashboard Tags -->
<dashboard-tags
    class="formPopupDashboard"
    *ngIf="showModalDashboardTags"
    (formDashboardTagsClosed)="handleCloseDashboardTags($event)">Load Dashboard Tags ...
</dashboard-tags>


<!-- Modal: Dashboard Settings -->
<dashboard-settings
    class="formPopupDashboard"
    *ngIf="showModalDashboardSettings"
    (formDashboardSettingsClosed)="handleCloseDashboardSettings($event)">Load Dashboard Settings ...
</dashboard-settings>


<!-- Modal: Dashboard Theme -->
<dashboard-theme
    class="formPopupDashboard"
    *ngIf="showModalDashboardTheme"
    (formDashboardThemeClosed)="handleCloseDashboardTheme($event)">Load Dashboard Theme ...
</dashboard-theme>


<!-- Modal: Dashboard Template -->
<dashboard-template
    class="formPopupDashboard"
    *ngIf="showModalDashboardTemplate"
    (formDashboardTemplateClosed)="handleCloseDashboardTemplate($event)">Load Dashboard Template ...
</dashboard-template>


<!-- Modal: Dashboard Schedule -->
<dashboard-schedule
    class="formPopupDashboard"
    *ngIf="showModalDashboardSchedule"
    (formDashboardScheduleClosed)="handleCloseDashboardSchedule($event)">Load Dashboard Schedule ...
</dashboard-schedule>


<!-- Modal: Dashboard Delete -->
<dashboard-delete
    class="formPopupDashboard"
    *ngIf="showModalDashboardDelete"
    (formDashboardDeleteClosed)="handleCloseDashboardDelete($event)">Load Dashboard Delete ...
</dashboard-delete>


<!-- Modal: Dashboard Treeview -->
<dashboard-treeview
    class="formPopupDashboard"
    *ngIf="showModalDashboardTreeview"
    (formDashboardTreeviewClosed)="handleCloseDashboardTreeview($event)">Load Dashboard Treeview ...
</dashboard-treeview>


<!-- Modal: Dashboard Subscribe -->
<dashboard-subscribe
    class="formPopupDashboard"
    *ngIf="showModalDashboardSubscribe"
    (formDashboardSubscribeClosed)="handleCloseDashboardSubscribe($event)">Load Dashboard Subscribe ...
</dashboard-subscribe>


<!-- Modal: Comments -->
<dashboard-comments
    class="formPopupDashboard"
    *ngIf="showModalDashboardComments"
    (formDashboardCommentsClosed)="handleCloseDashboardComments($event)">Load Comments ...
</dashboard-comments>


<!-- Modal: Dashboard Print -->
<dashboard-print
    class="formPopupDashboard"
    *ngIf="showModalDashboardPrint"
    (formDashboardPrintClosed)="handleCloseDashboardPrint($event)">Load Dashboard Print ...
</dashboard-print>


<!-- Modal: Widget Expand -->
<widget-expand
    class="formPopupDashboard"
    *ngIf="showModalWidgetExpand"
    (formWidgetExpandClosed)="handleCloseWidgetExpand($event)">Load Widget Expand ...
</widget-expand>


<!-- Modal: Widget Export -->
<widget-export
    class="formPopupDashboard"
    *ngIf="showModalWidgetExport"
    (formWidgetExportClosed)="handleCloseWidgetExport($event)">Load Widget Export ...
</widget-export>


<!-- Modal: Widget Delete -->
<widget-delete
    class="formPopupDashboard"
    *ngIf="showModalWidgetDelete"
    (formWidgetDeleteClosed)="handleCloseWidgetDelete($event)">Load Widget Delete ...
</widget-delete>


<!-- Modal: Shape Edit -->
<shape-edit
    class="formPopupDashboard"
    *ngIf="showModalShapeEdit"
    (formShapeEditClosed)="handleCloseShapeEdit($event)">Load Shape Edit ...
</shape-edit>


<!-- Modal: Shape Delete -->
<shape-delete
    class="formPopupDashboard"
    *ngIf="showModalShapeDelete"
    [currentShapeSpec]="currentShapeSpec"
    (formShapeDeleteClosed)="handleCloseShapeDelete($event)">Load Shape Delete ...
</shape-delete>


<!-- Overlay: Dashboard Help -->
<dashboard-help
    *ngIf="isFirstTimeDashboard"
    (formDashboardHelpClosed)="handleCloseDashboardHelp($event)">Load Help form ...
    >
</dashboard-help>


<!-- Overlay: Dashboard Help for Presentation -->
<dashboard-helpPresentation
    *ngIf="isFirstTimePresentation  &&  presentationMode"
    (formDashboardHelpPresentationClosed)="handleCloseDashboardHelpPresentation($event)">Load Help form ...
    >
</dashboard-helpPresentation>


<!-- Modal: Login -->
<login
    class="formPopupDashboard"
    *ngIf="showModalDashboardLogin"
    (formUserLoginClosed)="handleCloseUserLogin($event)">Load Login ...
</login>


<!-- Modal: Widget Button Bar -->
<widget-buttonbar
    class="formPopupUserWidgetButtonBar"
    *ngIf="showModalUserWidgetButtonBar"
    (formUserWidgetButtonBarClosed)="handleCloseUserWidgetButtonBar($event)">
    Load Widget Button Bar ...
</widget-buttonbar>


<!-- Modal: Shape Button Bar -->
<shape-buttonbar
    class="formPopupUserShapeButtonBar"
    *ngIf="showModalUserShapeButtonBar"
    (formUserShapeButtonBarClosed)="handleCloseUserShapeButtonBar($event)">
    Load Shape Button Bar ...
</shape-buttonbar>


<!-- Modal: System Settings -->
<systemsettings
    class="formPopupDashboard"
    *ngIf="showModalUserSystemSettings"
    (formDashboardSystemSettingsClosed)="handleCloseUserSystemSettings($event)">
    Load System Settings ...
</systemsettings>


<!-- Modal: Offline Mode -->
<user-offline
    class="formPopupDashboard"
    *ngIf="showModalUserOffline"
    (formUserOfflineClosed)="handleCloseUserOffline($event)">
    Load Offline Mode ...
</user-offline>


<!-- Modal: Logout -->
<logout
    class="formPopupDashboard"
    *ngIf="showModalDashboardLogout"
    (formUserLogoutClosed)="handleCloseUserLogout($event)">Load Logout ...
</logout>


<!-- Modal: My Profile -->
<myprofile
    class="formPopupDashboard"
    *ngIf="showModalUserMyProfile"
    (formDashboardMyProfileClosed)="handleCloseUserdMyProfile($event)">Load My Profile ...
</myprofile>


<!-- Modal: Preferences -->
<preferences
    class="formPopupDashboard"
    *ngIf="showModalUserPreferences"
    (formDashboardPreferencesClosed)="handleCloseUserPreferences($event)">Load Preferences ...
</preferences>


<!-- Modal: data Slicers -->
<data-slicers
    *ngIf="showModalDataSlicers"
    (formDataSlicersClosed)="handleCloseDataSlicers($event)">Load Data Slicers ...
</data-slicers>


<!-- Modal: data  -->
<data
    *ngIf="showModalData"
    (formDataPopupClosed)="handleCloseData($event)">Load Data ...
</data>


<!-- Modal: data Combination -->
<data-combination
    *ngIf="showModalDataCombination"
    (formDataCombinationClosed)="handleCloseDataCombination($event)">Load Data Combination ...
</data-combination>


<!-- Modal: data refresh all -->
<data-refresh
    *ngIf="showModalDataRefresh"
    (formDataRefreshClosed)="handleCloseDataRefresh($event)">Refresh All Data ...
</data-refresh>


<!-- Modal: data Share -->
<data-share
    *ngIf="showModalDataShare"
    (formDataShareClosed)="handleCloseDataShare($event)">Share All Data ...
</data-share>


<!-- Modal: widget editor -->
<widget-editor
    *ngIf="showModalWidgetEditor"
    (formWidgetEditorClosed)="handleCloseWidgetEditor($event)">Load Widget Editor ...
</widget-editor>


<!-- Modal: widget checkpoints -->
<widget-checkpoints
    *ngIf="showModalWidgetCheckpoints"
    (formWidgetCheckpointsClosed)="handleCloseWidgetCheckpoints($event)">Load Widget Checkpoints ...
</widget-checkpoints>


<!-- Modal: widget links -->
<widget-links
    *ngIf="showModalWidgetLinks"
    (formWidgetLinksClosed)="handleCloseWidgetLinks($event)">Load Widget Links ...
</widget-links>


<!-- Modal: widget Comments -->
<widget-comments
    *ngIf="showModalWidgetComments"
    (formWidgetCommentsClosed)="handleCloseWidgetComments($event)">Load Widget Comments ...
</widget-comments>


<!-- Modal: Alerts -->
<collaborate-alerts
    class="formPopupDashboard"
    *ngIf="showModalCollaborateAlerts"
    (formCollaborateAlertsClosed)="handleCloseCollaborateAlerts($event)">Load Alerts ...
</collaborate-alerts>


<!-- Modal: Messages -->
<collaborate-messages
    class="formPopupDashboard"
    *ngIf="showModalCollaborateMessages"
    (formCollaborateMessagesClosed)="handleCloseCollaborateMessages($event)">Load Messages ...
</collaborate-messages>


<!-- Modal: Activities -->
<collaborate-activities
    class="formPopupDashboard"
    *ngIf="showModalCollaborateActivities"
    (formCollaborateActivitiesClosed)="handleCloseCollaborateActivities($event)">Load Activities ...
</collaborate-activities>


<!-- Modal: ActivityAdd -->
<collaborate-activityadd
    class="formPopupDashboard"
    *ngIf="showModalCollaborateActivityAdd"
    (formCollaborateActivityAddClosed)="handleCloseCollaborateActivityAdd($event)">Load ActivityAdd ...
</collaborate-activityadd>


<!-- Model: Widget Refresh -->
<div class="modal modalBox" *ngIf="showModalWidgetRefresh">
	<div class="modal-dialog modal-sm" role="dialog" aria-hidden="true">
		<div class="modal-content modalContent">

            <div class="overall">
                <div class="closeButton">
                    <button type="button" class="closeButton" (click)="showModalWidgetRefresh=!showModalWidgetRefresh">
                        X
                    </button>
                </div>
                <i>
                    Note: The Datasource associated with this Widget is large, and may take a while
                    to Refresh.  While running, it will indicate 'Query Running' in the Statusbar
                    at the bottom of the screen.  You may stop it by clicking the <b>Cancel</b>
                    button on the Statusbar.  Once the query completes, the graph in the Widget will refresh
                    automatically.  You may have multiple queries running at the same time.
                    Do you want to continue?
                </i>
                <div>
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="showModalWidgetRefresh=!showModalWidgetRefresh"
                        >
                        Refresh
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Testings ... -->

<button
    type="button"
    class="btn btn-link"
    (click)="clickTest()"
    >
    Refresh
</button>


<!-- Widgets -->
<widget #widgetDOM
    [widgets]="currentWidgets"
    >
</widget>


<!-- Testing Arrows -->
<div *ngIf="showTestArrows">
    <div class="arrow"></div>


    <svg width="80%" height="80%" viewBox="-100 -100 200 200">
    <!-- Need this definition to make an arrowhead, from https://www.w3.org/TR/svg-markers/ -->
    <defs>
        <marker id="red-arrowhead" viewBox="0 0 10 10" refX="7" refY="5" markerUnits="strokeWidth" markerWidth="4" markerHeight="3" orient="auto">
        <path d="M 0 0 L 10 5 L 0 10 z" stroke="none" fill="red"/>
        </marker>
    </defs>
    <!-- example of lines with arrowheads: the size of the arrowhead will vary but you need a separate def per color -->
    <path d="M 50,-50 Q 80,0 40,80" stroke="red" stroke-width="3" fill="none" marker-end="url(#red-arrowhead)"/>
    </svg>


    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="svg-triangle" width='100' height='100'
        (dragstart)="dragStartArrow($event)"
        (dragend)="dragEndArrow($event)"
        draggable="true"
        #redArrow
        >
        <path d="M 50,5 95,97.5 5,97.5 z"/>
    </svg>


    <!-- Big Arrow -->
    <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 350 100">
        <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7"
        refX="0" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" />
        </marker>
        </defs>
        <line x1="0" y1="50" x2="250" y2="50" stroke="#000"
        stroke-width="8" marker-end="url(#arrowhead)" />
    </svg> -->
</div>

