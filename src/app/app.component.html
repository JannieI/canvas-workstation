<!-- ***********************************  MAIN MENU ************************************ -->

<!-- Main Dashboard & Tab Container -->
<clr-main-container>

    <!-- Header at top, that contains main menu -->
    <clr-header class="header-6" *ngIf="showMainMenu"
        style="z-index: 100;"
        >
        <div class="branding">
            <a href="http://clarityanalytics.xyz" class="nav-link">
                <span class="clr-icon ca-logo">
                <img src="../favicon.ico" height="35" width="35">
                </span>
                <span class="title">{{ companyName }}</span>
            </a>
        </div>

        <!-- // Main menu -->
        <div class="header-nav" [clr-nav-level]="1">
            <div>

                <!-- // Edit menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        [disabled] = "!currentUserID"
                        >
                        Edit
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button
                            type="button"
                            clrDropdownItem
                            (click)="clickMenuEditMode()"
                            title="Enable EditMode to make changes"
                            >
                            {{ editMenuText }}
                        </button>
                        
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            title="Undo previous action"
                            (click)="clickMenuEditUndo()"
                            >
                            Undo (Ctrl-Z)
                        </button>
                        <button type="button"
                            clrDropdownItem
                            title="Redo previous action"
                            (click)="clickMenuEditRedo()"
                            >
                            Redo (Ctrl-Y)
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            title="Select all the Widgets on this Tab"
                            (click)="clickMenuEditSelectAllNone('All')"
                            >
                            Select All
                        </button>
                        <button type="button"
                            clrDropdownItem
                            title="UnSelect all the Widgets on this Tab"
                            (click)="clickMenuEditSelectAllNone('None')"
                            >
                            Select None
                        </button>

                        <div class="dropdown-divider"></div>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Show recently opened Dashboards"
                                >
                                Container Styles
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuEditContainerStylesAdd()"
                                    title="Add a new container style"
                                    >
                                    Add
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuEditContainerStylesEdit()"
                                    title="Edit or Delete an existing container style"
                                    >
                                    Edit / Delete
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <button type="button"
                            clrDropdownItem
                            title="Manage Colours to be used in Widgets in Canvas"
                            (click)="clickMenuEditManageColours('None')"
                            >
                            Manage Colours
                        </button>

                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Dashboard menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="All actions related to Dashboards"
                        [disabled]="!currentUserID"
                        >
                        Dashboard
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            title="Add a new Dashboard"
                            (click)="clickDashboardNew()"
                            >
                            Add Dashboard
                        </button>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Show recently opened Dashboards"
                                >
                                Recent
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button *ngFor="let row of recentDashboards; let i = index"
                                    type="button"
                                    clrDropdownItem
                                    (click)="showRecentDashboard(i)">
                                    {{ i + 1 }} {{ row.nameAtRunTime }} ( {{row.stateAtRunTime}} )
                                    <clr-icon *ngIf="row.editMode"
                                        shape="pencil"
                                        class="selectIcon1"
                                        size="10"
                                        (dblclick)="dblclickDelete(i, row.id)"
                                        >
                                    </clr-icon>
                                </button>

                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Open an existing Dashboard"
                                >
                                Open
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button"
                                    clrDropdownItem
                                    title="Open a Dashboard"
                                    (click)="clickDashboardOpen()"
                                    >
                                    Existing Dashboard
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Submenu with more options"
                                >
                                Details
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="See and add Comments for this Dashboard"
                                    (click)="clickMenuDashboardDetailComments()"
                                    >
                                    Comments
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    title="Edit Dashboard Description details"
                                    (click)="clickMenuDashboardDetailDescription()"
                                    >
                                    Descripton
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="View Data Quality issues for this Dashboard"
                                    (click)="clickMenuDashboardDetailDataQuality()"
                                    >
                                    Data Quality
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    title="Mark/UnMark this Dashboard as a favourite"
                                    (click)="clickMenuDashboardDetailFavourite()"
                                    >
                                    Favourite
                                    <clr-icon
                                        shape="check"
                                        size="12"
                                        *ngIf="showFavouriteDashboard">
                                    </clr-icon>
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Manage tags for this Dashboard"
                                    (click)="clickMenuDashboardDetailTags()"
                                    >
                                    Tags
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Add/Delete a template for this Dashboard"
                                    (click)="clickMenuDashboardDetailTemplate()"
                                    >
                                    Template
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Manage Dashboard theme"
                                    (click)="clickMenuDashboardDetailTheme()"
                                    >
                                    Theme
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Show usage stats for this Dashboard"
                                    (click)="clickMenuDashboardUsageStats()"
                                    >
                                    Usage Stats
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Submenu with more options"
                                >
                                Save
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button type="button"
                                    clrDropdownItem
                                    title="Save the current Draft Dashboard (to the original)"
                                    (click)="clickDashboardSave()"
                                    >
                                    Save
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    title="Save the current Dashboard under a new name (copy)"
                                    (click)="clickDashboardSaveAs()"
                                    >
                                    Save As
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    title="Export the current Dashboard to a text file"
                                    (click)="clickDashboardExport()"
                                    >
                                    Export
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    title="Rename an existing Dashboard"
                                    (click)="clickDashboardRename()"
                                    >
                                    Rename
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    title="Discard changes to the current Dashboard"
                                    (click)="clickDashboardDiscard()"
                                    >
                                    Discard
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <button type="button"
                            clrDropdownItem
                            title="Share access to a Dashboard"
                            (click)="clickDashboardShare()"
                            >
                            Share
                        </button>
                        <button type="button"
                            clrDropdownItem
                            title="Manage Snapshots of the current Dashboard"
                            (click)="clickDashboardSnapshots()"
                            >
                            Snapshots
                        </button>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Submenu with more options"
                                >
                                Schedules
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button type="button"
                                    clrDropdownItem
                                    title="Manage scheduled runs for this Dashboard"
                                    (click)="clickMenuDashboardScheduleEdit()"
                                    >
                                    Manage
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Shows all scheduled runs"
                                    (click)="clickMenuDashboardSchedule()"
                                    >
                                    Show All
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDashboardSubscribe()"
                                    title="Manage Subscriptions"
                                    [style.color]="!currentUserID? 'lightgray' : '#565656'"
                                    [disabled] = "!currentUserID"
                                    >
                                    Subscribe
                                </button>


                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button type="button"
                            clrDropdownItem
                            title="Print the current Dashboard"
                            (click)="clickMenuDashboardPrint()"
                            >
                            Print
                        </button>

                        <div class="dropdown-divider"></div>
                        <button
                            type="button"
                            clrDropdownItem
                            title="Delete the current Dashboard"
                            (click)="clickMenuDashboardDelete()"
                            >
                            Delete
                        </button>

                        <button
                            type="button"
                            clrDropdownItem
                            title="Delete multiple Dashboards"
                            (click)="clickMenuDashboardDeleteBulk()"
                            >
                            Bulk Delete
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Data menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Manage Datasources"
                        [disabled]="!currentUserID"
                        >
                        Data
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Create a new Datasources (direct method)"
                                >
                                Create
                            </button>
                            <clr-dropdown-menu
                                clrPosition="right-top"
                                *clrIfOpen
                                >
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a Comma Separated Value TEXT file"
                                    (click)="clickMenuDataDirectFileCSV()"
                                    >
                                    From CSV File
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a JSON TEXT file"
                                    (click)="clickMenuDataDirectFileJSON()"
                                    >
                                    From JSON File
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a Spreadsheet"
                                    (click)="clickMenuDataDirectFileSpreadsheet()"
                                    >
                                    From Spreadsheet
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a Google Sheets Spreadsheet"
                                    (click)="clickMenuDataDirectGoogleSheets()"
                                    >
                                    From Google Sheets
                                </button>

                                <div class="dropdown-divider"></div>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a SQL Database using the Query Builder"
                                    (click)="clickMenuDataDirectQueryBuilder()"
                                    >
                                    From SQL Database (QB)
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a SQL Database using SQL statements in the Editor"
                                    (click)="clickMenuDataDirectSQLEditor()"
                                    >
                                    Using SQL Editor
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Create a new Datasources from a NoSQL Database"
                                    (click)="clickMenuDataDirectNoSQL()"
                                    >
                                    From NoSQL Database
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDataDirectService()"
                                    title="Create a new Datasources from a Service"
                                    >
                                    From Service
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDataDirectWeb()"
                                    title="Create a new Datasources from a web page"
                                    >
                                    From Web
                                </button>

                                <div class="dropdown-divider"></div>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDataDirectImport()"
                                    title="Import a new Datasources from an external file"
                                    >
                                    Import
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDataDirectExport()"
                                    title="Export a Datasources to an external file"
                                    >
                                    Export
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <clr-dropdown>

                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Create a new Managed Datasources"
                                >
                                Managed
                            </button>
                            <clr-dropdown-menu
                                clrPosition="right-top"
                                *clrIfOpen
                                >

                                <clr-dropdown>
                                    <button
                                        type="button"
                                        class="btn btn-link btn-sm"
                                        clrDropdownItem
                                        title="Manage Data Connections (to Databases, used in Datasources)"
                                        (click)="clickMenuDataManagedConnection()"
                                        >
                                        Connections
                                    </button>

                                    <div class="dropdown-divider"></div>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedQueryBuilder()"
                                        title="Create a new Datasources using Query Builder"
                                        >
                                        New Query Builder
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedSQLEditor()"
                                        title="Create a new Datasources using the SQL Editor"
                                        >
                                        New SQL Editor
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedOverlayEditor()"
                                        title="Create a new Datasources using the Overlay Editor"
                                        >
                                        New Overlay Editor
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedGraphQLEditor()"
                                        title="Create a new Datasources using the GraphQL Editor"
                                        >
                                        New GraphQL Editor
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedNoSQLEditor()"
                                        title="Create a new Datasources using the NoSQL query Editor"
                                        >
                                        New NoSQL Editor
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedNeo4jEditor()"
                                        title="Create a new Datasources using the Neo4j Editor"
                                        >
                                        New Ne04j Editor
                                    </button>

                                    <div class="dropdown-divider"></div>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataBussGlossary()"
                                        title="Manage Business Glossary for Datasources"
                                        >
                                        Manage Business Glossary
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedDataDictionary()"
                                        title="Manage Data Dictionary for Datasources"
                                        >
                                        Manage Data Dictionary
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedDataOwnership()"
                                        title="Manage Data Ownership for Datasources"
                                        >
                                        Manage Data Ownership
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataManagedDataQuality()"
                                        title="Manage Data Quality for Datasources"
                                        >
                                        Manage Data Quality
                                    </button>

                                </clr-dropdown>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <div class="dropdown-divider"></div>

                        <button
                            type="button"
                            class="btn btn-link btn-sm"
                            clrDropdownItem
                            title="Edit Datasources"
                            (click)="clickMenuDataEditDatasource()"
                            >
                            Edit
                        </button>

                        <button
                            type="button"
                            class="btn btn-link btn-sm"
                            clrDropdownItem
                            title="Show an overview of Datasources"
                            (click)="clickMenuDatasourceOverview()"
                            >
                            Overview
                        </button>

                        <button
                            type="button"
                            class="btn btn-link btn-sm"
                            clrDropdownItem
                            title="Share permissions to Datasources"
                            (click)="clickMenuDataShare()"
                            >
                            Share
                        </button>

                        <div class="dropdown-divider"></div>

                        <clr-dropdown>

                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Create Datasources by combining existing ones"
                                >
                                Combinations
                            </button>
                            <clr-dropdown-menu
                                clrPosition="right-top"
                                *clrIfOpen
                                >

                                <clr-dropdown>
                                    <button
                                        type="button"
                                        class="btn btn-link btn-sm"
                                        clrDropdownItem
                                        title="Append selected Datasources below each other"
                                        (click)="clickMenuDataCombinationAppend()"
                                        >
                                        Append
                                    </button>

                                    <div class="dropdown-divider"></div>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataCombinations('Join')"
                                        title="Join existing Datasources next to each other on a common field "
                                        >
                                        Join
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataCombinations('Intersection')"
                                        title="Show only rows in a Datasource where a key field exists in a second Datasource"
                                        >
                                        Intersection
                                    </button>
                                    <button
                                        type="button"
                                        clrDropdownItem
                                        (click)="clickMenuDataCombinations('Minus')"
                                        title="Show rows in a Datasource where a key field does NOT exist in a second Datasource"
                                        >
                                        Minus/Subtract
                                    </button>

                                </clr-dropdown>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button
                            type="button"
                            class="btn btn-link btn-sm"
                            clrDropdownItem
                            title="Show a summary of Data Usage Datasources (ie Dashboard where used)"
                            (click)="clickMenuDatasourceUsage()"
                            >
                            Usage
                        </button>

                        <div class="dropdown-divider"></div>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Submenu with more options"
                                >
                                Schedules
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button type="button"
                                    clrDropdownItem
                                    title="Manage scheduled runs for this Datasource"
                                    (click)="clickMenuDatasourceScheduleEdit()"
                                    >
                                    Manage
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    title="Shows all scheduled runs"
                                    (click)="clickMenuDatasourceSchedule()"
                                    >
                                    Show All
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>


                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Refresh Datasources"
                                >
                                Refresh
                            </button>
                            <clr-dropdown-menu
                                clrPosition="right-top"
                                *clrIfOpen
                                >
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDatasourceRefreshOnce()"
                                    title="Refresh all or some Datasources once off"
                                    >
                                    Once
                                </button>
                                <button
                                    type="button"
                                    clrDropdownItem
                                    (click)="clickMenuDatasourceRefreshRepeat()"
                                    title="Refresh Datasources for this Dashboard repeatedly"
                                    >
                                    Repeat
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <div class="dropdown-divider"></div>
                        <button
                            type="button"
                            class="btn btn-link btn-sm"
                            clrDropdownItem
                            (click)="clickMenuDataDeleteDatasource()"
                            title="Shows a list of Datasources to delete from"
                            >
                            Delete
                        </button>

                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Graph menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Managing selected Widget"
                        >
                        Graph
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetNew()"
                            title="Add a new Widget"
                            >
                            Add Graph
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetEdit()"
                            title="Edit selected Widget"
                            >
                            Edit Graph
                        </button>
                        <div class="dropdown-divider"></div>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Submenu with more options"
                                >
                                Details
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetContainer('Graph')"
                                    title="Change container properties for selected Widget"
                                    >
                                    Container
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetDescription()"
                                    title="Description for the selected Widget"
                                    >
                                    Description
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetEditTitle()"
                                    title="Edit title of selected Widget"
                                    >
                                    Edit Title
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetTablist()"
                                    title="Manage Tabs to which selected Widget belongs"
                                    >
                                    Tablist
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetFullScreen()"
                                    title="Show the selected Widget in full screen"
                                    >
                                    Full Screen
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetAnnotations()"
                                    title="Annotations for selected Widget"
                                    >
                                    Annotations
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetCheckpoints()"
                                    title="Managing checkpoints for selected Widget"
                                    >
                                    Checkpoints
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetComments()"
                                    title="Comments for selected Widget"
                                    >
                                    Comments
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetHyperlinks()"
                                    >
                                    Hyperlinks
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>


                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Options on underlying Datasource"
                                >
                                Data related
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetBusinessGlossary()"
                                    title="Business Glossary for Datasource of the selected Widget"
                                    >
                                    Business Glossary
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetDataDictionary()"
                                    title="Data Dictionary for Datasource of the selected Widget"
                                    >
                                    Data Dictionary
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetDataQuality()"
                                    title="Data quality issues for the selected Widget"
                                    >
                                    Data Quality
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetDataSummary()"
                                    title="Data Summary for Datasource of the selected Widget"
                                    >
                                    Data Summary
                                </button>

                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuWidgetRefresh()"
                                    title="Refresh Datasource linked to selected Widget"
                                    >
                                    Refresh
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetCopy()"
                            title="Copy selected Widget"
                            >
                            Copy (Ctrl-C)
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuPaletteDuplicate()"
                            title="Duplicate selected Widget"
                            >
                            Duplicate
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetExpand()"
                            title="Expand Dataset for selected Widget"
                            >
                            Expand
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetExport()"
                            title="Export Dataset for selected Widget"
                            >
                            Export
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetLockUnlock()"
                            title="Toggle Lock/UnLock for the selected Widget"
                            >
                            Lock/UnLock
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetPaste()"
                            title="Paste previously copied Widget"
                            >
                            Paste (Ctrl-V)
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetDelete()"
                            title="Delete selected Widget"
                            >
                            Delete Graph
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Table menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Manage selected Table"
                        >
                        Table
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableAdd()"
                            title="Add a new Table"
                            >
                            Add Table
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableEdit()"
                            title="Edit selected Table"
                            >
                            Edit Table
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableComments()"
                            title="Comments for selected Table"
                            >
                            Comments
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetContainer('Table')"
                            title="Change container properties for selected Table"
                            >
                            Container
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableDataQuality()"
                            title="Data quality issues for selected Table"
                            >
                            Data Quality
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuPaletteDuplicate()"
                            title="Duplicate selected Table"
                            >
                            Duplicate
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableExpand()"
                            title="Expand Dataset for selected Table"
                            >
                            Expand
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableExport()"
                            title="Export Dataset for selected Table"
                            >
                            Export
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetLockUnlock()"
                            title="Toggle Lock/UnLock for the selected Table"
                            >
                            Lock/UnLock
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetTablist()"
                            title="Manage Tabs to which selected Table belongs"
                            >
                            Tablist
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuTableDelete()"
                            title="Delete selected Table"
                            >
                            Delete Table
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Slicer menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        [disabled] = "!hasDatasources  ||  !currentUserID"
                        title="Manage selected Slicer"
                        >
                        Slicer
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerAdd()"
                            title="Add a new Slicer"
                            >
                            Add Slicer
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerEdit()"
                            title="Edit selected Slicer"
                            >
                            Edit Slicer
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerComments()"
                            title="Comments for selected Slicer"
                            >
                            Comments
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetContainer('Slicer')"
                            title="Change container properties for selected Slicer"
                            >
                            Container
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerDataQuality()"
                            title="Data quality for selected Slicer"
                            >
                            Data Quality
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuPaletteDuplicate()"
                            title="Duplicate selected Slicer"
                            >
                            Duplicate
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerExpand()"
                            title="Expand Dataset for selected Slicer"
                            >
                            Expand
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerExport()"
                            title="Export Dataset for selected Slicer"
                            >
                            Export
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetLockUnlock()"
                            title="Toggle Lock/UnLock for the selected Slicer"
                            >
                            Lock/UnLock
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetTablist()"
                            title="Manage Tabs to which selected Slicer belongs"
                            >
                            Tablist
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuSlicerDelete()"
                            title="Delete selected Slicer"
                            >
                            Delete Slicer
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Shape menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Manage Shapes in this Dashboard"
                        [disabled] = "!currentUserID"
                        >
                        Shape
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeNew()"
                            title="Add a new Shape to this Dashboard"
                            >
                            Add Shape
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeEdit()"
                            title="Edit the selected Shape"
                            >
                            Edit Shape
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeComments()"
                            title="Comments for selected Shape"
                            >
                            Comments
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetContainer('Shape')"
                            title="Change container properties for selected Shape"
                            >
                            Container
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetCopy()"
                            title="Copy selected Shape"
                            >
                            Copy (Ctrl-C)
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuPaletteDuplicate()"
                            title="Duplicate selected Shape"
                            >
                            Duplicate
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeEditTitle()"
                            title="Edit title of selected Widget"
                            >
                            Edit Title
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeHyperLinks()"
                            title="Manage hyperlinks on selected Shape"
                            >
                            Hyperlinks
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetLockUnlock()"
                            title="Toggle Lock/UnLock for the selected Shape"
                            >
                            Lock/UnLock
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetPaste()"
                            title="Paste previously copied Shape"
                            >
                            Paste (Ctrl-V)
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuWidgetTablist()"
                            title="Manage Tabs to which selected Shape belongs"
                            >
                            Tablist
                        </button>

                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeDelete()"
                            title="Delete selected Shapes"
                            >
                            Delete Shape
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuShapeDeleteAll()"
                            title="Delete ALL Shapes on the current tab"
                            >
                            Delete ALL Shapes
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- View menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Manage how to view this Dashboard"
                        [disabled] = "!currentUserID"
                        >
                        View
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewHideMenu()"
                            title="Hide menu"
                            >
                            Hide Menu
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewPrintPreview()"
                            title="Toggle print preview on/off"
                            >
                            Print preview
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuDashboardTreeview()"
                            title="Create of TreeView of this Dashboard"
                            >
                            Treeview
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewShowPalette()"
                            title="Toggles a background grid"
                            >
                            Show Palette
                            <clr-icon shape="check" size="12" *ngIf="showPalette"></clr-icon>
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewShowGrid()"
                            title="Toggles a background grid"
                            >
                            Show grid
                            <clr-icon shape="check" size="12" *ngIf="showGrid"></clr-icon>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewSnapToGrid()"
                            title="Toggle whether resize and move will snap to a grid"
                            >
                            Snap to Grid
                            <clr-icon shape="check" size="12" *ngIf="snapToGrid"></clr-icon>
                        </button>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Size of the grid for this Dashboard"
                                >
                                Grid size
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item" clrDropdownItem>Small</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Medium</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>Large</button>
                            </clr-dropdown-menu>
                        </clr-dropdown>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Zoom % for this Dashboard"
                                >
                                Zoom %
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item" clrDropdownItem>50%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>75%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>100%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>150%</button>
                                <button type="button" class="dropdown-item" clrDropdownItem>200%</button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuViewZoom(0.6)"
                            title="100% zoom"
                            >
                            Zoom 100%
                        </button>
                        <div class="dropdown-divider"></div>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Arrange menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        [disabled] = "!editMode"
                        title="Arrange selected Widgets"
                        [disabled] = "!currentUserID"
                        >
                        Arrange
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuArrangeBackward()"
                            title="Move selected Widgets backward in z-plane"
                            >
                            Backward
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuArrangeForward()"
                            title="Move selected Widgets forward in z-plane"
                            >
                            Forward
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuArrangeBack()"
                            title="Move selected Widgets to the back in z-plane"
                            >
                            Back
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuArrangeFront()"
                            title="Move selected Widgets to the front in z-plane"
                            >
                            Front
                        </button>
                        <div class="dropdown-divider"></div>

                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Align selected Widgets"
                                >
                                Align
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignLeft()"
                                    title="Align selected Widgets to the left"
                                    >
                                    Left
                                </button>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignCenter()"
                                    title="Align selected Widgets to the center"
                                    >
                                    Center</button>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignRight()"
                                    title="Align selected Widgets to the right"
                                    >
                                    Right</button>
                                <div class="dropdown-divider"></div>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignTop()"
                                    title="Align selected Widgets to the top"
                                    >
                                    Top
                                </button>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignMiddle()"
                                    title="Align selected Widgets to the middle"
                                    >
                                    Middle</button>
                                <button type="button" class="dropdown-item"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignBottom()"
                                    title="Align selected Widgets to the bottom"
                                    >
                                    Bottom</button>
                                <div class="dropdown-divider"></div>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignCenterHorisontally()"
                                    title="Align selected Widgets horisontally on page"
                                    >
                                    Center horisontally
                                    <clr-icon shape="two-way-arrows down"></clr-icon>
                                </button>
                                <button type="button"
                                    clrDropdownItem
                                    (click)="clickMenuArrangeAlignCenterVertically()"
                                    title="Align selected Widgets vertically on page"
                                    >
                                    Center vertically
                                    <clr-icon shape="two-way-arrows right"></clr-icon>
                                </button>
                            </clr-dropdown-menu>
                        </clr-dropdown>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem (click)="clickMenuArrangeGroup()"
                            title="Group selected Widgets"
                            >
                            Group
                        </button>
                        <button type="button"
                            clrDropdownItem (click)="clickMenuArrangeUnGroup()"
                            title="Ungroup previosly selected Widgets"
                            >
                            Ungroup
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem (click)="clickMenuArrangeDistributeHorisontal()"
                            title="Distribute selected Widgets horisontally"
                            >
                            Distribute
                            <clr-icon shape="two-way-arrows"></clr-icon>
                        </button>
                        <button type="button"
                            clrDropdownItem (click)="clickMenuArrangeDistributeVertical()"
                            title="Distribute selected Widgets vertically"
                            >
                            Distribute
                            <clr-icon shape="two-way-arrows right"></clr-icon>
                        </button>
                        <div class="dropdown-divider"></div>
                        <clr-dropdown>
                            <button
                                type="button"
                                class="btn btn-link btn-sm"
                                clrDropdownTrigger
                                title="Make selected Widgets the same size"
                                >
                                Same size
                            </button>
                            <clr-dropdown-menu clrPosition="right-top" *clrIfOpen>

                                <button type="button"
                                    clrDropdownItem (click)="clickMenuArrangeSameSizeVertically()"
                                    title="Make selected Widgets the same size vertically"
                                    >
                                    Same vertically
                                </button>

                                <button type="button"
                                    clrDropdownItem (click)="clickMenuArrangeSameSizeHorisontally()"
                                    title="Make selected Widgets the same size horisontally"
                                    >
                                    Same horisontally
                                </button>

                                <button type="button"
                                    clrDropdownItem (click)="clickMenuArrangeSameSize()"
                                    title="Make selected Widgets the same size"
                                    >
                                    Same both
                                </button>

                            </clr-dropdown-menu>
                        </clr-dropdown>
                    </clr-dropdown-menu>
                </clr-dropdown>

                <!-- Help menu -->
                <clr-dropdown class="menuText">
                    <button
                        type="button"
                        class="btn btn-link btn-sm menuButton"
                        clrDropdownTrigger
                        title="Help options"
                        >
                        Help
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickMenuHelpDemo()"
                            title="Demo Dashboards for clarification"
                            >
                            Demo
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpGettingStarted()"
                            title="Getting started with Canvas"
                            >
                            Getting started with Canvas
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpGetData()"
                            title="How to add Datasources to a Dashboard"
                            >
                            Getting data
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpCreateDashboard()"
                            title="Easy steps to create a Dashboard"
                            >
                            Creating a Dashboard
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpCreateWidget()"
                            title="Steps to create a Widget (graph, table, etc)"
                            >
                            Creating a Widget
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpTransformData()"
                            title="How to transform the data in a Datasource"
                            >
                            Transforming data
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpTutorials()"
                            title="Tutorials in selected functionality"
                            >
                            Tutorials
                        </button>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickHelpDocumentation()"
                            title="Full documentation"
                            >
                            Documentation
                        </button>
                        <div class="dropdown-divider"></div>
                        <button type="button"
                            clrDropdownItem
                            (click)="clickSave()"
                            title="How and where to get support"
                            >
                            Support
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>

            </div>
        </div>

        <!-- Header Actions on right hand side -->
        <div class="header-actions">
            <clr-dropdown class="dropdown"
            >
                <button class="nav-icon" clrDropdownTrigger
                    [disabled] = "!currentUserID"
                    >
                    <clr-icon shape="share"></clr-icon>
                    <clr-icon shape="caret down"></clr-icon>
                </button>
                <clr-dropdown-menu clrPosition="bottom-right" *clrIfOpen>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateAuditTrail()"
                        title="Show Audit Trail"
                        >
                        Audit Trail
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateMessages()"
                        title="Manage Messages"
                        >
                        Messages
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateTasks()"
                        title="Manage Tasks"
                        >
                        Tasks
                    </button>
                    <div class="dropdown-divider"></div>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateSendMessageAdd()"
                        title="Send a Canvas Message"
                        >
                        Send Message
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateSendEmailAdd()"
                        title="Send an email"
                        >
                        Send Email
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuCollaborateTaskAdd()"
                        title="Add a new Task"
                        >
                        Add Task
                    </button>
                    <div class="dropdown-divider"></div>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuViewDontDisturb()"
                        title="Toggles a background grid"
                        >
                        Dont Disturb
                        <clr-icon shape="check" size="12" *ngIf="dontDisturb"></clr-icon>
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuViewSystemMessages()"
                        title="System generated messages"
                        >
                        System Messages
                    </button>
            </clr-dropdown-menu>
            </clr-dropdown>

            <clr-dropdown class="dropdown">
                <button class="nav-icon" clrDropdownTrigger>
                    <clr-icon shape="user" class="is-solid has-alert"></clr-icon>
                    <clr-icon shape="caret down"></clr-icon>
                </button>
                <clr-dropdown-menu clrPosition="bottom-right" *clrIfOpen>
                    <button
                        type="button"
                        clrDropdownItem
                        (click)="clickMenuEditMode()"
                        title="Enable EditMode to make changes"
                        >
                        <i>
                            {{ currentUserID? currentUserID : 'Not logged in' }}
                        </i>
                    </button>

                    <div class="dropdown-divider"></div>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuGroups()"
                        title="Show Groups with its users"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        Groups
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUserMyPermissions()"
                        title="Show my Permissions"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        My Permissions
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUserMyProfile()"
                        title="Show my profile"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        My Profile
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUserPaletteButtonBar()"
                        title="Manage Palette ButtonBar"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        Palette ButtonBar
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUserPreferences()"
                        title="Show my Preferences"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        Preferences
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUsers()"
                        title="Show Users with its groups"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        Users
                    </button>
                    <button type="button"
                        clrDropdownItem
                        (click)="clickMenuUserSystemSettings()"
                        title="Show System Settings"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        >
                        System Settings
                    </button>

                    <div class="dropdown-divider"></div>
                    <button type="button"
                        clrDropdownItem
                        title="Log out of Canvas"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        (click)="clickMenuUserLogin()"
                        >
                        Login
                    </button>

                    <button type="button"
                        clrDropdownItem
                        title="Log out of Canvas"
                        [style.color]="!currentUserID? 'lightgray' : '#565656'"
                        [disabled] = "!currentUserID"
                        (click)="clickMenuUserLogout()"
                        >
                        Log out
                    </button>
                </clr-dropdown-menu>
            </clr-dropdown>

        </div>
    </clr-header>

    <!-- Rubber Band -->
    <!-- <div class="rubberband" *ngIf="rubberbandShow"
        [style.height.px]="rubberbandHeight"
        [style.left.px]="rubberbandLeft"
        [style.top.px]="rubberbandTop"
        [style.width.px]="rubberbandWidth"
        >
    </div> -->


    <!-- Presentation popup Button -->
    <div class="presentationButton dropdown" *ngIf="!showMainMenu">
        <clr-dropdown>
            <button type="button" clrDropdownTrigger>
                <clr-icon shape="bars"></clr-icon>
            </button>

            <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
                <button
                    type="button"
                    class="btn btn-link btn-sm"
                    clrDropdownItem
                    title="Shows the first Dashboard Tab: Ctrl-Home"
                    (click)="dashboardPageFirst()"
                    >
                    <clr-icon shape="step-forward down" size="14"></clr-icon>
                    First Tab
                </button>
                <button
                    type="button"
                    class="btn btn-secondary btn-sm"
                    clrDropdownItem
                    title="Jumps to the Next Dashboard Tab: PageDown"
                    (click)="dashboardPageDown()"
                    >
                    <clr-icon shape="fast-forward" size="14"></clr-icon>
                    Next Tab
                </button>
                <button
                    type="button"
                    class="btn btn-secondary btn-sm"
                    clrDropdownItem
                    title="Returns to the Previous Dashboard Tab: PageUp"
                    (click)="dashboardPageUp()"
                    >
                    <clr-icon shape="rewind" size="14"></clr-icon>
                    Previous Tab
                </button>
                <button
                    type="button"
                    class="btn btn-secondary btn-sm"
                    clrDropdownItem
                    title="Shows the Last Dashboard Tab: Ctrl-End"
                    (click)="dashboardPageLast()"
                    >
                    <clr-icon shape="step-forward" size="14"></clr-icon>
                    Last Tab
                </button>
                <button
                    type="button"
                    class="btn btn-secondary btn-sm"
                    clrDropdownItem
                    (click)="clickShowMenu()"
                    title="Shows the main menu"
                    >
                    <clr-icon shape="times" size="20"></clr-icon>
                    Show Menu
                </button>
            </clr-dropdown-menu>
        </clr-dropdown>
    </div>



<!-- TEST -->

<!-- <div> <input type="text" [(ngModel)]="testIndexDB">    </div> -->


        <!-- TEST ENDs -->

    <!-- ****************************  WIDGETS & RELATED FORMS ***************************** -->

    <!-- Widget Popup -->
    <div class="widgetPopupMenu" *ngIf="showWidgetContextMenu"
        [style.left.px]="popupLeft"
        [style.top.px]="popupTop"
        >
        <!-- Container for This Widget -->
        <clr-icon shape="keyboard" 
            (click)="clickMenuWidgetContainer(popupWidgetType, popupWidgetID)"
            >
        </clr-icon>

        <!-- Optional Hyperlink      -->
        <clr-icon shape="arrow right" *ngIf="popupHyperlinkDashboardID"
            (click)="actionmenuJumpToLinked(popupHyperlinkDashboardID, popupHyperlinkDashboardTabID)"
            >
        </clr-icon>
        Use menu at top
        <!-- <clr-icon
            (click)="togglePaletteHorisontal()"
            shape="trash"
            size="18"
            >
        </clr-icon> -->
    </div>

    <!-- Widget Container -->
    <div class="widgetContainer" *ngFor="let row of currentWidgets; let i = index"
        [style.background-color]="row.containerBackgroundcolor"
        [style.border]="row.containerBorder"
        [style.border-radius]="row.containerBorderRadius"
        [style.box-shadow]="row.containerBoxshadow"
        [style.font-size.px]="row.containerFontsize"
        [style.height.px]="row.containerHeight"
        [style.left.px]="row.containerLeft"
        [style.top.px]="row.containerTop"
        [style.width.px]="row.containerWidth"
        [style.z-index]="row.containerZindex"
        (click)="clickWidget($event, i, row.id)"
        (dblclick)="clickMenuPaletteEdit(row.id, null, true, row.widgetType)"
        (dragstart)="clickWidgetContainerDragStart($event, i)"
        (dragend)="clickWidgetContainerDragEnd($event, row.id)"
        draggable="true"
        (contextmenu)="popupMenuOpen($event, i, row.id, row.containerLeft, row.containerTop)"
        >

        <!-- Drag Handles -->
        <div class="widgetContainerTopLeftHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, true, false, false, true)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerTopHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, true, false, false, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerTopRightHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, true, true, false, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerRightTopHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, true, true, false, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerRightHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, true, false, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerRightBottomHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, true, true, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerBottomRightHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, true, true, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerBottomLeftHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, false, true, true)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerBottomHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, false, true, false)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerLeftBottomHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, false, true, true)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerLeftHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, false, false, false, true)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>
        <div class="widgetContainerLeftTopHandle" *ngIf="editMode"
            [style.background-color]="row.isSelected? '#929699' : 'transparent'"
            (mousedown)="clickResizeWidgetDown($event, i)"
            (dragend)="clickResizeWidgetUp($event, i, true, false, false, true)"
            draggable="true"
            [style.z-index]="row.containerZindex+1"
            >
        </div>

        <!-- W related info menu -->
        <div class="widgetRelatedInfoMenu" *ngIf="row.widgetType=='Graph'  &&  row.containerHasContextMenus"
            [style.color]="row.titleColor"
            [style.z-index]="row.containerZindex"
            >
            <clr-dropdown>
                <clr-icon
                    clrDropdownTrigger
                    shape="ellipsis-vertical"
                    size="24"
                    >
                </clr-icon>
                <clr-dropdown-menu class="widgetTitleMenu"
                    *clrIfOpen
                    >
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetAnnotations($event, i, row.id)"
                        >
                        Annotations
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetMessages($event, i, row.id)"
                        >
                        Messages
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetCheckpoints($event, i, row.id)"
                        >
                        Checkpoints
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetChanges($event, i, row.id)"
                        >
                        Changes
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetShare()"
                        >
                        Access/Share
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetDataSummary($event, i, row.id)"
                        >
                        Data summary
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetDataQuality($event, i, row.id)"
                        >
                        Data quality
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetDataDictionary($event, i, row.id)"
                        >
                        Data dictionary
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="contextmenuWidgetUsageStats($event, i, row.id)"
                        >
                        Usage stats
                    </button>

                </clr-dropdown-menu>
            </clr-dropdown>
        </div>

        <!-- Widget Content -->
        <div class="widget">

            <!-- Title Container -->
            <div class="widgetTitle" *ngIf="row.containerHasTitle"
                [style.background-color]="row.titleBackgroundColor"
                [style.border]="row.titleBorder"
                [style.border-top-left-radius]="row.containerBorderRadius"
                [style.border-top-right-radius]="row.containerBorderRadius"
                [style.color]="showWidgetForSlicer(row.id, row.datasourceID, row.datasetID)? 'red' : row.titleColor"
                [style.font-weight]="row.titleFontWeight"
                [style.font-size.px]="row.titleFontsize"
                [style.height.px]="row.titleHeight==0 ? '24' : row.titleHeight"
                [style.margin]="row.titleMargin"
                [style.padding]="row.titlePadding"
                [style.text-align]="row.titleTextAlign"
                [style.width.%]="row.titleWidth? row.titleWidth : '100'"
                [style.z-index]="row.containerZindex+1"
                >

                <!-- Annotation -->
                <span style="display: inline-block" *ngIf="row.annotation">
                    <clr-signpost>
                        <clr-icon shape="info-circle"
                            clrSignpostTrigger>
                        </clr-icon>
                            <clr-signpost-content *clrIfOpen>
                            <h4 style="margin-top: 0; color:gray;">
                                <b>Annotation</b>
                            </h4>
                            <p style="margin-top: 0; color:gray;"> {{ row.annotation }}
                            </p>
                            <span *ngIf="row.annotationLastUserID"
                                style="color:gray; font-size: 12px; font-style:italic;"
                                >
                                ( {{ row.annotationLastUserID }} - {{ row.annotationLastUpdated }} )
                            </span>
                        </clr-signpost-content>
                    </clr-signpost>
                </span>

                <!-- Data Quality Issues -->
                <span style="display: inline-block" *ngIf="row.nrDataQualityIssues>0">
                    <clr-icon shape="exclamation-triangle"
                        class="dqIcon"
                        (click)="contextmenuWidgetDataQuality($event, i, row.id)"
                        >
                    </clr-icon>
                </span>

                <!-- Title Text -->
                <span class="widgetTitleText"
                    (click)="clickMenuPaletteWidgetTitle(row.id)"
                    >
                    <b>{{ row.titleText }}</b>
                </span>
                <!-- <b>
                    <input class="widgetTitleEdit"
                        [(ngModel)]="row.titleText"
                        type="text"
                        [disabled]="true"
                        >
                </b> -->
                <!-- Hyperlink -->
                <span class="widgetJumpLink" *ngIf="row.hyperlinkDashboardID
                     && row.hyperlinkDashboardTabID"
                    >
                    <clr-icon shape="arrow right" *ngIf="row.hyperlinkDashboardID"
                        (click)="actionmenuJumpToLinked(row.hyperlinkDashboardID, row.hyperlinkDashboardTabID)"
                        >
                    </clr-icon>
                </span>

            </div>

            <!-- Graph Object -->
            <div class="widgetGraph" *ngIf="row.widgetType=='Graph'  &&  !row.showCheckpoints">
                <widget-single
                    #widgetDOMX
                    [widget]="row"
                    style="margin: 0; padding: 0; white-space: normal; background-color: transparent;"
                    >
                </widget-single>
            </div>

            <!-- Slicer Object -->
            <div class="widget" *ngIf="row.widgetType=='Slicer'"
                (click)="clickWidgetSlicer($event, i, row.id)"
                >
                <slicer-single
                    [slicer]="row"
                    >
                </slicer-single>
            </div>

            <!-- Table Object -->
            <div class="widget" *ngIf="row.widgetType=='Table'">
                <table-single
                    [table]="row"
                    >
                </table-single>
            </div>

            <!-- Shape Circle Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Circle'">
                <svg [style.height]="row.containerHeight-2"
                    [style.width]="row.containerWidth-2"
                    [style.margin.px]="2"
                    >
                    <circle
                        [style.cx]="row.containerWidth/2"
                        [style.cy]="row.containerHeight/2"
                        [style.r]="(row.containerWidth-26)/2"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        />
                </svg>
            </div>

            <!-- Shape Ellipse Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Ellipse'">
                <svg [style.height]="row.containerHeight-2"
                    [style.width]="row.containerWidth-2"
                    [style.margin.px]="0"
                    >
                    <ellipse
                        [style.cx]="row.containerWidth/2"
                        [style.cy]="row.containerHeight/2"
                        [style.rx]="(row.containerWidth-26)/2"
                        [style.ry]="(row.containerHeight-26)/2"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        />
                </svg>
            </div>

            <!-- Shape Rectangle Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Rectangle'">
                <svg
                [style.height.px]="row.containerHeight-2"
                    [style.width.px]="row.containerWidth-2"
                    [style.margin.px]="4"
                    >
                    <rect
                        [style.height.px]="row.containerHeight-10"
                        [style.width.px]="row.containerWidth-10"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        [style.opacity]="row.shapeOpacity"
                        [style.rx]="row.shapeCorner"
                        [style.ry]="row.shapeCorner"
                        />
                </svg>
            </div>

            <!-- Shape Text Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Text'"

                [style.color]="row.shapeTextColour"
                [style.font-style]="row.shapeIsItalic? 'italic' : 'normal'"
                [style.font-weight]="row.shapeIsBold? 'bold' : 'normal'"
                [style.font-family]="row.shapeFontFamily"
                [style.font-size.px]="row.shapeFontSize"
                [style.height.px]="1"
                [style.line-height]="row.shapeLineHeight"
                [style.text-align]="row.shapeTextAlign"
                [style.width.px]="row.containerWidth"
                [innerHtml]="row.shapeTextDisplay"
                style="margin: 0; padding: 0; white-space: normal; background-color: transparent;"
                >
                <!-- {{ row.shapeTextDisplay }} -->
                <!-- <svg width="300" height="300">
                    <text
                        x="20"
                        y="150"
                        [style.fill]="row.shapeTextColour"
                        [style.color]="row.shapeTextColour"
                        >
                        {{ row.shapeText }}
                    </text>
                </svg> -->

            </div>

            <!-- Shape Brackets Object -->
            <!-- Note:        0                   90                  180                 270  -->
            <!-- x increase   ?                   up + right-top      right               down+right -->
            <!-- y increase   ?                   down + right        down                left -->

            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Brackets'">
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 50, 40) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 20, 20) scale(1,2)"
                        [style.stroke]="row.shapeStroke"

                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 5, 20) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 5, 10) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 10, 5) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 25, 25) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 10, 25) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 5, 10) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 10, 5) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 40, 40) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 10, 40) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 0, 15) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

            </div>

            <!-- Shape Arrow Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Arrow'">
                <!-- TODO - Makey this DYNAMIC !!!  -->
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 11 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 15 10) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 15 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 11 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>

                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 16 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 16 26) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 25 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 21 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 25 23) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 29 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 26 26) scale(2 2)"
                        stroke-width:1
                        />
                </svg>

                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 21 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 26 36) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 33 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 33 36) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 36 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 41 29) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 45 38) scale(3 3)"
                        stroke-width:1
                        />
                </svg>


            </div>

            <!-- Shape ArrowThin Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='ArrowThin'">
                <svg width="180" height="180"
                    [attr.transform]="'translate(0, 0) rotate(' + row.shapeRotation + ')'"
                    >
                    <defs>
                        <marker id="markerCircle"
                            markerWidth="8"
                            markerHeight="8"
                            refX="5"
                            refY="5"
                            >

                            <circle
                                [style.stroke]="row.shapeStroke"
                                [style.fill]="row.shapeStroke"
                                cx="5"
                                cy="5"
                                r="3"
                                />
                        </marker>

                        <marker id="markerArrow"
                            markerWidth="13"
                            markerHeight="13"
                            refX="2"
                            refY="6"
                            orient="auto"
                            >
                            <path d="M2,2 L2,11 L10,6 L2,2"
                                [style.stroke]="row.shapeStroke"
                                [style.fill]="row.shapeStroke"
                                />
                        </marker>
                    </defs>

                    <path d="M90,90 L160,90"
                        [style.stroke]="row.shapeStroke"
                        [style.fill]="row.shapeStroke"
                        style="stroke-width: 1px;
                            marker-start: url(#markerCircle);
                            marker-end: url(#markerArrow);
                            "
                            />
                </svg>
                <!-- <svg [style.height.px]="row.containerHeight"
                    [style.width.px]="row.containerWidth"
                    [style.marginTop.px]="-25"
                    [style.marginLeft.px]="-9"
                    [style.transform]="'rotate(' + row.shapeRotation + 'deg)'"
                    >
                    <defs>
                        <marker id="arrowThin"
                            markerWidth="10"
                            markerHeight="10"
                            refX="0"
                            refY="3"
                            orient="auto"
                            markerUnits="strokeWidth">
                        <path
                            d="M0,0 L0,6 L9,3 z"
                            [style.fill]="row.shapeStroke"
                            />
                        </marker>
                    </defs>

                    <line
                        x1="1"
                        y1="1"
                        x2="55"
                        y2="55"
                        [style.stroke]="row.shapeStroke"
                        stroke-width="5"
                        marker-end="url(#arrowThin)"
                        />
                </svg> -->
            </div>

            <!-- Shape Image Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Image'">
                <img [style.height.px]="row.containerHeight-10"
                    [style.width.px]="row.containerWidth-10"
                    [style.marginTop.px]="0"
                    [style.marginLeft.px]="0"
                    [src]="row.shapeImageUrl"
                    >
                    <!-- <iframe width="420" height="345" src="https://www.youtube.com/embed/tgbNymZ7vqY">
                    </iframe> -->
            </div>

            <!-- Shape Bullets Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Bullets'">
                <ul  *ngIf="!row.shapeBulletsOrdered"
                    [style.list-style-type]="row.shapeBulletStyleType"
                    >
                    <li *ngFor="let bullet of row.shapeBullet"
                        [style.color]="row.shapeTextColour"
                        [style.font-family]="row.shapeFontFamily"
                        [style.font-size.px]="row.shapeFontSize"
                        [style.margin-bottom.px]="row.shapeBulletMarginBottom"
                        >
                        {{ bullet.text }}
                        <clr-icon shape="arrow right" *ngIf="bullet.linkedTabID"
                            (click)="clickBulletJump(bullet.linkedTabID)">
                        </clr-icon>
                    </li>
                </ul>
                <ol  *ngIf="row.shapeBulletsOrdered"
                    >
                    <li *ngFor="let bullet of row.shapeBullet"
                        [style.color]="row.shapeTextColour"
                        [style.font-family]="row.shapeFontFamily"
                        [style.font-size.px]="row.shapeFontSize"
                        [style.margin-bottom.px]="row.shapeBulletMarginBottom"
                        >
                        {{ bullet.text }}
                        <clr-icon shape="arrow right" *ngIf="bullet.linkedTabID"
                            (click)="clickBulletDelete(i, row)">
                        </clr-icon>
                    </li>
                </ol>
            </div>

            <!-- Shape Value Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Value'">
                <div
                    [style.width.px]="row.containerWidth"
                    [style.background-color]="row.containerBackgroundcolor"
                    [style.font-size.px]="row.shapeFontSize"
                    [style.font-style]="'italic'"
                    [style.font-weight]="'bold'"
                    [style.font-family]="row.shapeFontFamily"
                    [style.color]="row.shapeStroke"
                    [style.text-align]="center"
                    [style.margin.px]="4"
                    >
                    {{ row.shapeText }}
                </div >
            </div>

            <!-- Graph Checkpoint -->
            <div class="widget" *ngIf="row.widgetType=='Graph'  &&  row.showCheckpoints">
                <widget-single
                    #widgetDOM
                    [widget]="row"
                    >
                </widget-single>
            </div>

            <!-- Checkpoint -->
            <div class="widgetCheckpoint" *ngIf="row.lastCheckpoint >= 0"
                >
                <div class="widgetCheckpointLeft" *ngIf="row.showCheckpoints"
                    (click)="clickNavCheckpoint(
                        i,
                        row.dashboardID,
                        row.id,
                        'Left',
                        row.showCheckpoints,
                        row.checkpointIDs,
                        row.currentCheckpoint,
                        row.lastCheckpoint
                        )"
                    >
                    <b> < </b>
                </div>

                <div *ngIf="!row.showCheckpoints"
                    class="widgetCheckpointCenter"
                    (click)="clickToggleShowCheckpoint(
                        i,
                        row.dashboardID,
                        row.id,
                        row.showCheckpoints)"
                    >
                    <span class="widgetCheckpointShowCheckpoint">
                    </span>
                </div>

                <div *ngIf="row.showCheckpoints"
                    class="widgetCheckpointCenter"
                    (click)="clickToggleShowCheckpoint(
                        i,
                        row.dashboardID,
                        row.id,
                        row.showCheckpoints)"
                    >
                    <span class="widgetCheckpointShowWidget">
                    </span>
                </div>

                <div  *ngIf="row.showCheckpoints"
                    class="widgetCheckpointAnimate"
                    (click)="clickAnimateCheckpoint(
                        i,
                        row.dashboardID,
                        row.id,
                        'Right',
                        row.showCheckpoints,
                        row.checkpointIDs,
                        row.currentCheckpoint,
                        row.lastCheckpoint
                        )"
                    >
                    <b> >> </b>
                </div>

                <div *ngIf="row.showCheckpoints  &&  (row.currentCheckpoint < row.lastCheckpoint)"
                    class="widgetCheckpointRight"
                    (click)="clickNavCheckpoint(
                        i,
                        row.dashboardID,
                        row.id,
                        'Right',
                        row.showCheckpoints,
                        row.checkpointIDs,
                        row.currentCheckpoint,
                        row.lastCheckpoint
                        )"
                    >
                    <b> > </b>
                </div>
            </div>

        </div>

        <!-- W action menu -->
        <div class="widgetActionMenu" *ngIf="(row.widgetType=='Graph'
            || row.widgetType=='Table'
            || (row.widgetType=='Slicer'  && row.containerHasTitle)
            || (row.widgetType=='Shape'  &&  row.widgetSubType=='Value') )
            &&  row.containerHasContextMenus"
            [style.color]="row.titleColor"
            [style.z-index]="row.containerZindex"
            >
            <clr-dropdown>
                <clr-icon
                    clrDropdownTrigger
                    shape="caret down"
                    size="24"
                    >
                </clr-icon>
                <clr-dropdown-menu class="widgetTitleMenu"
                    clrPosition="bottom-right" *clrIfOpen
                    >
                    <button class="dropdown-item" *ngIf="row.widgetType=='Graph'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetEditor($event, i, row.id)"
                        >
                        Graph Editor
                    </button>
                    <button class="dropdown-item" *ngIf="row.widgetType=='Graph'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetExplore($event, i, row.id)"
                        >
                        Explore
                    </button>
                    <button class="dropdown-item" *ngIf="row.widgetType=='Graph'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetFullScreen($event, i, row.id)"
                        >
                        Full screen
                    </button>
                    <button class="dropdown-item" *ngIf="row.widgetType=='Graph'
                        || row.widgetType=='Table'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetDescription($event, i, row.id)"
                        >
                        Description
                    </button>
                    <button class="dropdown-item"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetEditTitle($event, i, row.id)"
                        >
                        Edit Title
                    </button>

                    <button class="dropdown-item" *ngIf="row.widgetType == 'Graph'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetFlipToTable(row.id)"
                        >
                        Flip to Table
                    </button>
                    <button class="dropdown-item" *ngIf="row.widgetType == 'Table'"
                        type="button"
                        clrDropdownItem
                        (click)="actionmenuWidgetFlipToGraph(row.id)"
                        >
                        Flip to Graph
                    </button>

                </clr-dropdown-menu>
            </clr-dropdown>
        </div>

    </div>

    <!-- Template Widgets -->
    <!-- NB - All click events, etc removed.   -->
    <div class="widgetContainer" *ngFor="let row of templateWidgets; let i = index"
        [style.background-color]="row.containerBackgroundcolor"
        [style.border]="row.containerBorder"
        [style.border-radius]="row.containerBorderRadius"
        [style.box-shadow]="row.containerBoxshadow"
        [style.font-size.px]="row.containerFontsize"
        [style.height.px]="row.containerHeight"
        [style.left.px]="row.containerLeft"
        [style.top.px]="row.containerTop"
        [style.width.px]="row.containerWidth"
        [style.z-index]="10"
        [style.opacity]="editMode? 0.5 : 1"
        style="pointer-events: none; user-select: none;"
        draggable="false"
        >

        <!-- Widget Content -->
        <div class="widget">

            <!-- Title Container -->
            <div class="widgetTitle" *ngIf="row.containerHasTitle"
                [style.background-color]="row.titleBackgroundColor"
                [style.border]="row.titleBorder"
                [style.border-top-left-radius]="row.containerBorderRadius"
                [style.border-top-right-radius]="row.containerBorderRadius"
                [style.color]="showWidgetForSlicer(row.id, row.datasourceID, row.datasetID)? 'red' : row.titleColor"
                [style.font-weight]="row.titleFontWeight"
                [style.font-size.px]="row.titleFontsize"
                [style.height.px]="row.titleHeight==0 ? '24' : row.titleHeight"
                [style.margin]="row.titleMargin"
                [style.padding]="row.titlePadding"
                [style.text-align]="row.titleTextAlign"
                [style.width.%]="row.titleWidth? row.titleWidth : '100'"
                [style.z-index]="row.containerZindex+1"
                >

                <!-- Title Text -->
                <b>{{ row.titleText }}</b>

            </div>

            <!-- Graph Object -->
            <div class="widgetGraph" *ngIf="row.widgetType=='Graph'">
                <widget-single
                    #widgetDOMX
                    [widget]="row"
                    >
                </widget-single>
            </div>

            <!-- Slicer Object -->
            <div class="widget" *ngIf="row.widgetType=='Slicer'"
                >
                <slicer-single
                    [slicer]="row"
                    >
                </slicer-single>
            </div>

            <!-- Table Object -->
            <div class="widget" *ngIf="row.widgetType=='Table'">
                <table-single
                    [table]="row"
                    >
                </table-single>
            </div>

            <!-- Shape Circle Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Circle'">
                <svg [style.height]="row.containerHeight-2"
                    [style.width]="row.containerWidth-2"
                    [style.margin.px]="2"
                    >
                    <circle
                        [style.cx]="row.containerWidth/2"
                        [style.cy]="row.containerHeight/2"
                        [style.r]="(row.containerWidth-26)/2"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        />
                </svg>
            </div>

            <!-- Shape Ellipse Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Ellipse'">
                <svg [style.height]="row.containerHeight-2"
                    [style.width]="row.containerWidth-2"
                    [style.margin.px]="0"
                    >
                    <ellipse
                        [style.cx]="row.containerWidth/2"
                        [style.cy]="row.containerHeight/2"
                        [style.rx]="(row.containerWidth-26)/2"
                        [style.ry]="(row.containerHeight-26)/2"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        />
                </svg>
            </div>

            <!-- Shape Rectangle Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Rectangle'">
                <svg
                [style.height.px]="row.containerHeight-2"
                    [style.width.px]="row.containerWidth-2"
                    [style.margin.px]="4"
                    >
                    <rect
                        [style.height.px]="row.containerHeight-10"
                        [style.width.px]="row.containerWidth-10"
                        [style.stroke]="row.shapeStroke"
                        [style.stroke-width.px]="row.shapeStrokeWidth"
                        [style.fill]="row.shapeFill"
                        [style.opacity]="row.shapeOpacity"
                        [style.rx]="row.shapeCorner"
                        [style.ry]="row.shapeCorner"
                        />
                </svg>
            </div>

            <!-- Shape Text Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Text'"

                [style.height.px]="1"
                [style.color]="row.shapeTextColour"
                [style.font-style]="row.shapeIsItalic? 'italic' : 'normal'"
                [style.font-weight]="row.shapeIsBold? 'bold' : 'normal'"
                [style.font-family]="row.shapeFontFamily"
                [style.font-size.px]="row.shapeFontSize"
                [style.line-height]="row.shapeLineHeight"
                [style.width.px]="row.containerWidth"
                [style.text-align]="row.shapeTextAlign"
                style="margin: 0; padding: 0; white-space: normal;"
                >
                {{ row.shapeTextDisplay }}
                <!-- <svg width="300" height="300">
                    <text
                        x="20"
                        y="150"
                        [style.fill]="row.shapeTextColour"
                        [style.color]="row.shapeTextColour"
                        >
                        {{ row.shapeText }}
                    </text>
                </svg> -->

            </div>

            <!-- Shape Brackets Object -->
            <!-- Note:        0                   90                  180                 270  -->
            <!-- x increase   ?                   up + right-top      right               down+right -->
            <!-- y increase   ?                   down + right        down                left -->

            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Brackets'">
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 50, 40) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 20, 20) scale(1,2)"
                        [style.stroke]="row.shapeStroke"

                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 5, 20) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==1
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 5, 10) scale(1,2)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 10, 5) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 25, 25) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 10, 25) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==3
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 5, 10) scale(1,3)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==0"
                    >
                    <text x="2" y="14"
                        transform="rotate(0, 10, 5) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==90"
                    >
                    <text x="2" y="14"
                        transform="rotate(90, 40, 40) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==180"
                    >
                    <text x="2" y="14"
                        transform="rotate(180, 10, 40) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>
                <svg height="150" width="150" *ngIf="row.shapeSize==5
                    &&
                    row.shapeRotation==270"
                    >
                    <text x="2" y="14"
                        transform="rotate(270, 0, 15) scale(1,5)"
                        [style.stroke]="row.shapeStroke"
                        >}
                    </text>
                </svg>

            </div>

            <!-- Shape Arrow Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Arrow'">
                <!-- TODO - Makey this DYNAMIC !!!  -->
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 11 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 11 11) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 15 10) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 15 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==1
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 11 15) scale(1 1)"
                        stroke-width:1
                        />
                </svg>

                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 16 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 16 26) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 25 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 21 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 25 23) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 29 21) scale(2 2)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==2
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 26 26) scale(2 2)"
                        stroke-width:1
                        />
                </svg>

                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==0"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==45"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(45 21 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==90"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(90 26 36) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==135"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(135 33 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==180"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(180 33 36) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==225"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(225 36 31) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==270"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(270 41 29) scale(3 3)"
                        stroke-width:1
                        />
                </svg>
                <svg class="widgetShapeArrow" *ngIf="row.shapeSize==3
                        &&
                        row.shapeRotation==315"
                    height="100"
                    width="100"
                    viewBox="5 5 95 95"
                    style="display: block;"
                    >
                    <polygon
                        points="0, 10 10, 0 10, 5 20, 5 20, 15 10, 15 10, 20 0, 10"
                        [style.fill]="row.shapeFill"
                        [style.stroke]="row.shapeStroke"
                        viewBox="0 0 20 20"
                        transform="rotate(315 45 38) scale(3 3)"
                        stroke-width:1
                        />
                </svg>


            </div>

            <!-- Shape ArrowThin Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='ArrowThin'">
                <svg width="180" height="180"
                    [attr.transform]="'translate(0, 0) rotate(' + row.shapeRotation + ')'"
                    >
                    <defs>
                        <marker id="markerCircle"
                            markerWidth="8"
                            markerHeight="8"
                            refX="5"
                            refY="5"
                            >

                            <circle
                                [style.stroke]="row.shapeStroke"
                                [style.fill]="row.shapeStroke"
                                cx="5"
                                cy="5"
                                r="3"
                                />
                        </marker>

                        <marker id="markerArrow"
                            markerWidth="13"
                            markerHeight="13"
                            refX="2"
                            refY="6"
                            orient="auto"
                            >
                            <path d="M2,2 L2,11 L10,6 L2,2"
                                [style.stroke]="row.shapeStroke"
                                [style.fill]="row.shapeStroke"
                                />
                        </marker>
                    </defs>

                    <path d="M90,90 L160,90"
                        [style.stroke]="row.shapeStroke"
                        [style.fill]="row.shapeStroke"
                        style="stroke-width: 1px;
                            marker-start: url(#markerCircle);
                            marker-end: url(#markerArrow);
                            "
                            />
                </svg>
                <!-- <svg [style.height.px]="row.containerHeight"
                    [style.width.px]="row.containerWidth"
                    [style.marginTop.px]="-25"
                    [style.marginLeft.px]="-9"
                    [style.transform]="'rotate(' + row.shapeRotation + 'deg)'"
                    >
                    <defs>
                        <marker id="arrowThin" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path
                            d="M0,0 L0,6 L9,3 z"
                            [style.fill]="row.shapeStroke"
                            />
                        </marker>
                    </defs>

                    <line
                        x1="1"
                        y1="1"
                        x2="55"
                        y2="55"
                        [style.stroke]="row.shapeStroke"
                        stroke-width="5"
                        marker-end="url(#arrowThin)"
                        />
                </svg> -->
            </div>

            <!-- Shape Image Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Image'">
                <img [style.height.px]="row.containerHeight-10"
                    [style.width.px]="row.containerWidth-10"
                    [style.marginTop.px]="0"
                    [style.marginLeft.px]="0"
                    [src]="row.shapeImageUrl"
                    >
                    <!-- <iframe width="420" height="345" src="https://www.youtube.com/embed/tgbNymZ7vqY">
                    </iframe> -->
            </div>

            <!-- Shape Bullets Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Bullets'">
                <ul  *ngIf="!row.shapeBulletsOrdered"
                    [style.list-style-type]="row.shapeBulletStyleType"
                    >
                    <li *ngFor="let bullet of row.shapeBullet"
                        [style.color]="row.shapeTextColour"
                        [style.font-family]="row.shapeFontFamily"
                        [style.font-size.px]="row.shapeFontSize"
                        [style.margin-bottom.px]="row.shapeBulletMarginBottom"
                        >
                        {{ bullet.text }}
                    </li>
                </ul>
                <ol  *ngIf="row.shapeBulletsOrdered"
                    >
                    <li *ngFor="let bullet of row.shapeBullet"
                        [style.color]="row.shapeTextColour"
                        [style.font-family]="row.shapeFontFamily"
                        [style.font-size.px]="row.shapeFontSize"
                        [style.margin-bottom.px]="row.shapeBulletMarginBottom"
                        >
                        {{ bullet.text }}
                    </li>
                </ol>
            </div>

            <!-- Shape Value Object -->
            <div class="widget" *ngIf="row.widgetType=='Shape'  &&  row.widgetSubType=='Value'">
                <div
                    [style.width.px]="row.containerWidth"
                    [style.background-color]="row.containerBackgroundcolor"
                    [style.font-size.px]="row.shapeFontSize"
                    [style.font-style]="'italic'"
                    [style.font-weight]="'bold'"
                    [style.font-family]="row.shapeFontFamily"
                    [style.color]="row.shapeStroke"
                    [style.text-align]="center"
                    [style.margin.px]="4"
                    >
                    {{ row.shapeText }}
                </div >
            </div>


        </div>

    </div>

    <!-- Routed area -->
    <div class="content-container"
        [style.background-image]="showGrid? 'url(../images/gridBlock.png)' : (currentDashboardBackgroundImage? 'url(../images/' + currentDashboardBackgroundImage + ')' : '')"
        [style.background-color]="currentDashboardBackgroundColor"
        >
        <div  class="content-area"
            (click)="clickDashboard($event)"
            (mousedown)="mousedownDashboard($event)"
            (mouseup)="mouseupDashboard($event)"
            (contextmenu)="popupMenuOpen($event, -1, -1, 0, 0)"
            >
            <router-outlet ></router-outlet>
        </div>
    </div>

    <!-- Status Bar -->
    <status-bar *ngIf="showMainMenu"
        #statusbarDOM
        [currentDashboardName]="currentDashboardName"
        [currentTabName]="currentTabName"
        [currentDashboardTabIndex]="currentDashboardTabIndex"
        [currentTabBackgroundColor]="currentTabBackgroundColor"
        [currentTabColor]="currentTabColor"
        [statusBarRunning]="statusBarRunning"
        [statusBarCancelRefresh]="statusBarCancelRefresh"
        [templateInUse]="templateInUse"
        >
    </status-bar>

</clr-main-container>





<!-- ****************************  POPUP FORMS / WINDOWS ***************************** -->

<div class="popupMessage" *ngIf="showPopupMessage">
    In order to change the dashboard (ie. edit, move, duplicate, etc), you have to be in
    EditMode.  This is on the <b>Edit</b> menu option.  Note that it is only possible to
    edit if you have the appropriate role, and correct rights to the Dashboard.
    <b>Got it</b> <input type="checkbox" (click)="clickGotIt()">
</div>






<!-- ***********************************  MODAL FORMS *********************************** -->

<!-- Modal: landing page -->
<landing *ngIf="showModalLanding"
    (formLandingClosed)="handleCloseModalLanding($event)">Load landing page ...
</landing>


<!-- Palette -->
<div class="paletteIcon"
    [style.left.px]="paletteLeft+2"
    [style.top.px]="paletteTop+2"
    >
    <clr-icon
        (click)="togglePaletteHorisontal()"
        shape="angle right"
        size="9"
        >
    </clr-icon>
</div>

<div class="palette" *ngIf="editMode  &&  showPalette"
    [style.left.px]="paletteLeft"
    [style.top.px]="paletteTop"
    [style.height.px]="paletteHeight"
    [style.width.px]="paletteWidth"

    (dragstart)="clickPaletteDragStart($event)"
    (dragend)="clickPaletteDragEnd($event)"
    draggable="true"
    >

    <span *ngFor="let row of paletteButtons; let i = index"
        role="tooltip"
        aria-haspopup="true"
        class="tooltip tooltip-md tooltip-top-left"
        >
        <clr-icon
            [attr.shape]="row.shape"
            [attr.size]="row.size"
            class="buttonBarIcon"
            [style.background-color]="row.backgroundColor"
            (click)="paletteFunctionCall(row.functionName, row.params)"
            draggable="true"
            (dragstart)="dragstartPaletteButton($event)"
            (dragend)="dragendPaletteButton($event, row.functionName)"
            >
        </clr-icon>
        <span class="tooltip-content">{{ row.tooltipContent }}</span>
    </span>

</div>


<!-- Modal: Widget Container Styles Add -->
<widget-containerStylesAdd
    *ngIf="showModalWidgetContainerStylesAdd"
    (formWidgetContainerStylesAddClosed)="handleCloseWidgetContainerStylesAdd($event)">Widget Container Styles Add ...
</widget-containerStylesAdd>


<!-- Modal: Widget Container Styles Edit -->
<widget-containerStylesEdit
    *ngIf="showModalWidgetContainerStylesEdit"
    (formWidgetContainerStylesEditClosed)="handleCloseWidgetContainerStylesEdit($event)">Widget Container Styles Edit ...
</widget-containerStylesEdit>


<!-- Modal: Manage Colours -->
<manage-colours
    *ngIf="showModalManageColours"
    (formManageColoursClosed)="handleCloseManageColours($event)">Manage Colours ...
</manage-colours>


<!-- Title properties -->
<widget-title *ngIf="showTitleForm"
    (formWidgetTitleClosed)="handleCloseWidgetTitle($event)"
    [selectedWidget]="selectedWidget"
    >
    Load Widget Title page ...
</widget-title>


<!-- Modal: new Dashboard -->
<dashboard-new
    class="formPopupDashboard"
    *ngIf="showModalDashboardNew"
    (formDashboardNewClosed)="handleCloseDashboardNew($event)">Load New Dashboard ...
</dashboard-new>


<!-- Modal: open Dashboard -->
<dashboard-open
    class="formPopupDashboard"
    *ngIf="showModalDashboardOpen"
    (formDashboardOpenClosed)="handleCloseDashboardOpen($event)">Load Open Dashboard ...
</dashboard-open>


<!-- Modal: save Dashboard -->
<dashboard-save
    class="formPopupDashboard"
    *ngIf="showModalDashboardSave"
    (formDashboardSaveClosed)="handleCloseDashboardSave($event)">Load Save Dashboard ...
</dashboard-save>


<!-- Modal: saveAs Dashboard -->
<dashboard-save-as
    class="formPopupDashboard"
    *ngIf="showModalDashboardSaveAs"
    (formDashboardSaveAsClosed)="handleCloseDashboardSaveAs($event)">Load Save As Dashboard ...
</dashboard-save-as>


<!-- Modal: Export Dashboard -->
<dashboard-export
    class="formPopupDashboard"
    *ngIf="showModalDashboardExport"
    (formDashboardExportClosed)="handleCloseDashboardExport($event)">Load Export Dashboard ...
</dashboard-export>


<!-- Modal: discard Dashboard -->
<dashboard-discard
    class="formPopupDashboard"
    *ngIf="showModalDashboardDiscard"
    (formDashboardDiscardClosed)="handleCloseDashboardDiscard($event)">Load Discard Dashboard ...
</dashboard-discard>


<!-- Modal: rename Dashboard -->
<dashboard-rename
    class="formPopupDashboard"
    *ngIf="showModalDashboardRename"
    (formDashboardRenameClosed)="handleCloseDashboardRename($event)">Load Rename Dashboard ...
</dashboard-rename>


<!-- Modal: Dashboard Description -->
<dashboard-description
    class="formPopupDashboard"
    [selectedDashboard]="selectedDashboard"
    *ngIf="showModalDashboardDescription"
    (formDashboardDescriptionClosed)="handleCloseDashboardDescription($event)">Load Dashboard Description ...
</dashboard-description>


<!-- Modal: Snapshots -->
<dashboard-snapshots
    class="formPopupDashboard"
    *ngIf="showModalDashboardSnapshots"
    (formDashboardSnapshotsClosed)="handleCloseDashboardSnapshots($event)">Load Snapshots Dashboard ...
</dashboard-snapshots>


<!-- Modal: Share -->
<dashboard-share
    class="formPopupDashboard"
    *ngIf="showModalDashboardShare"
    [selectedDashboard]="selectedDashboard"
    (formDashboardShareClosed)="handleCloseDashboardShare($event)">Load Share Dashboard ...
</dashboard-share>


<!-- Modal: Dashboard Tags -->
<dashboard-tags
    class="formPopupDashboard"
    *ngIf="showModalDashboardTags"
    [selectedDashboard]="selectedDashboard"
    (formDashboardTagsClosed)="handleCloseDashboardTags($event)">Load Dashboard Tags ...
</dashboard-tags>


<!-- Modal: Dashboard Theme -->
<dashboard-theme
    class="formPopupDashboard"
    *ngIf="showModalDashboardTheme"
    (formDashboardThemeClosed)="handleCloseDashboardTheme($event)">Load Dashboard Theme ...
</dashboard-theme>


<!-- Modal: Dashboard Template -->
<dashboard-template
    class="formPopupDashboard"
    *ngIf="showModalDashboardTemplate"
    (formDashboardTemplateClosed)="handleCloseDashboardTemplate($event)">Load Dashboard Template ...
</dashboard-template>


<!-- Modal: Dashboard Show all Schedules -->
<dashboard-schedule
    class="formPopupDashboard"
    *ngIf="showModalDashboardSchedule"
    (formDashboardScheduleClosed)="handleCloseDashboardSchedule($event)">Load Show all Dashboard Schedule ...
</dashboard-schedule>


<!-- Modal: Manage current Dashboard Schedule -->
<dashboard-scheduleEdit
    class="formPopupDashboard"
    *ngIf="showModalDashboardScheduleEdit"
    (formDashboardScheduleEditClosed)="handleCloseDashboardScheduleEdit($event)">Load Manage current Dashboard Schedule ...
</dashboard-scheduleEdit>


<!-- Modal: Dashboard Delete -->
<dashboard-delete
    class="formPopupDashboard"
    *ngIf="showModalDashboardDelete"
    (formDashboardDeleteClosed)="handleCloseDashboardDelete($event)">Load Dashboard Delete ...
</dashboard-delete>


<!-- Modal: Dashboard Delete Bulk-->
<dashboard-bulk-delete
    class="formPopupDashboard"
    *ngIf="showModalDashboardDeleteBulk"
    (formDashboardDeleteClosed)="handleCloseDashboardDeleteBulk($event)">Load Dashboard Bulk Delete ...
</dashboard-bulk-delete>


<!-- Modal: Dashboard Treeview -->
<dashboard-treeview
    class="formPopupDashboard"
    *ngIf="showModalDashboardTreeview"
    (formDashboardTreeviewClosed)="handleCloseDashboardTreeview($event)">Load Dashboard Treeview ...
</dashboard-treeview>


<!-- Modal: Dashboard Subscribe -->
<dashboard-subscribe
    class="formPopupDashboard"
    *ngIf="showModalDashboardSubscribe"
    (formDashboardSubscribeClosed)="handleCloseDashboardSubscribe($event)">Load Dashboard Subscribe ...
</dashboard-subscribe>


<!-- Modal: Dashboard Usage Stats -->
<dashboard-usagestats
    class="formPopupDashboard"
    *ngIf="showModalDashboardUsageStats"
    (formDashboardUsageStatsClosed)="handleCloseDashboardUsageStats($event)">Load Dashboard Usage Stats ...
</dashboard-usagestats>


<!-- Modal: Annotations -->
<widget-annotations
    class="formPopupDashboard"
    *ngIf="showModalWidgetAnnotations"
    [selectedWidget]="selectedWidget"
    (formWidgetAnnotationsClosed)="handleCloseWidgetAnnotations($event)">Load Annotations ...
</widget-annotations>


<!-- Modal: Comments -->
<dashboard-comments
    class="formPopupDashboard"
    *ngIf="showModalDashboardComments"
    [selectedWidgetID]="selectedWidgetID"
    (formDashboardCommentsClosed)="handleCloseDashboardComments($event)">Load Comments ...
</dashboard-comments>


<!-- Modal: DataQuality -->
<dashboard-dataquality
    class="formPopupDashboard"
    *ngIf="showModalDashboardDataQuality"
    [selectedDatasourceID]="selectedDatasourceID"
    (formDashboardDataQualityClosed)="handleCloseDashboardDataQuality($event)">Load DataQuality ...
</dashboard-dataquality>


<!-- Modal: Dashboard Print -->
<dashboard-print
    class="formPopupDashboard"
    *ngIf="showModalDashboardPrint"
    (formDashboardPrintClosed)="handleCloseDashboardPrint($event)">Load Dashboard Print ...
</dashboard-print>


<!-- Modal: Data Direct From CSV -->
<data-direct-fileCSV
    class="formPopupDashboard"
    *ngIf="showModalDataDirectFileCSV"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectFileCSVClosed)="handleCloseDataDirectFileCSV($event)">Load Data Direct From CSV ...
</data-direct-fileCSV>


<!-- Modal: Data Direct From JSON -->
<data-direct-fileJSON
    class="formPopupDashboard"
    *ngIf="showModalDataDirectFileJSON"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectFileJSONClosed)="handleCloseDataDirectFileJSON($event)">Load Data Direct From JSON ...
</data-direct-fileJSON>


<!-- Modal: Data Direct From Spreadsheet -->
<data-direct-fileSpreadsheet
    class="formPopupDashboard"
    *ngIf="showModalDataDirectFileSpreadsheet"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectFileSpreadsheetClosed)="handleCloseDataDirectFileSpreadsheet($event)">Load Data Direct From Spreadsheet ...
</data-direct-fileSpreadsheet>


<!-- Modal: Data Direct From GoogleSheets -->
<data-direct-googlesheets
    class="formPopupDashboard"
    *ngIf="showModalDataDirectGoogleSheets"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectGoogleSheetsClosed)="handleCloseDataDirectGoogleSheets($event)">Load Data Direct From GoogleSheets ...
</data-direct-googlesheets>


<!-- Modal: Data Direct Query Builder -->
<data-directQueryBuilder
    *ngIf="showModalDataDirectQueryBuilder"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectQueryBuilderClosed)="handleCloseDataDirectQueryBuilder($event)">Load Direct SQL Query Builder ...
</data-directQueryBuilder>


<!-- Modal: Data Direct From SQL -->
<data-direct-sqlEditor
    class="formPopupDashboard"
    *ngIf="showModalDataDirectSQLEditor"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectSQLEditorClosed)="handleCloseDataDirectSQLEditor($event)">Load Data Direct From SQL ...
</data-direct-sqlEditor>


<!-- Modal: Data Direct From NoSQL -->
<data-direct-Nosql
    class="formPopupDashboard"
    *ngIf="showModalDataDirectNoSQL"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectNoSQLEditorClosed)="handleCloseDataDirectNoSQL($event)">Load Data Direct From NoSQL ...
</data-direct-Nosql>


<!-- Modal: Data Direct From Service -->
<data-direct-service
    class="formPopupDashboard"
    *ngIf="showModalDataDirectService"
    (formDataDirectServiceClosed)="handleCloseDataDirectService($event)">Load Data Direct From Service ...
</data-direct-service>


<!-- Modal: Data Direct From Web -->
<data-direct-web
    class="formPopupDashboard"
    *ngIf="showModalDataDirectWeb"
    [editingDS]="editingDS"
    [selectedDatasource]="selectedDatasource"
    (formDataDirectWebClosed)="handleCloseDataDirectWeb($event)">Load Data Direct From Web ...
</data-direct-web>


<!-- Modal: Data Direct Import DS -->
<data-direct-import
    class="formPopupDashboard"
    *ngIf="showModalDataDirectImport"
    (formDataDirectImportClosed)="handleCloseDataDirectImport($event)">Load Data Direct Import DS ...
</data-direct-import>


<!-- Modal: Data Direct Export DS -->
<data-direct-export
    class="formPopupDashboard"
    *ngIf="showModalDataDirectExport"
    (formDataDirectExportClosed)="handleCloseDataDirectExport($event)">Load Data Direct Export DS ...
</data-direct-export>


<!-- Modal: Data Managed Connection -->
<data-managed-connection
    *ngIf="showModalDataManagedConnection"
    (formDataManagedConnectionClosed)="handleCloseDataManagedConnection($event)">Load Data Managed Connection ...
</data-managed-connection>


<!-- Modal: Data Manged Query Builder -->
<data-managedQueryBuilder
    *ngIf="showModalDataManagedQueryBuilder"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedQueryBuilderClosed)="handleCloseDataManagedQueryBuilder($event)">Load Managed SQL Query Builder ...
</data-managedQueryBuilder>


<!-- Modal: Data Managed SQL Editor -->
<data-managedSqlEditor
    *ngIf="showModalDataManagedSQLEditor"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedSQLEditorClosed)="handleCloseDataManagedSQLEditor($event)">Load Managed SQL Editor ...
</data-managedSqlEditor>


<!-- Modal: Data Managed GraphQL Editor -->
<data-managedGraphqlEditor
    *ngIf="showModalDataManagedGraphQLEditor"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedGraphQLEditorClosed)="handleCloseDataManagedGraphQLEditor($event)">Load Managed GraphQL Editor ...
</data-managedGraphqlEditor>


<!-- Modal: Data Managed NoSQL Editor -->
<data-managedNoSqlEditor
    *ngIf="showModalDataManagedNoSQLEditor"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedNoSQLEditorClosed)="handleCloseDataManagedNoSQLEditor($event)">Load Managed NoSQL Editor ...
</data-managedNoSqlEditor>


<!-- Modal: Data Managed Neo4j Editor -->
<data-managedNeo4jEditor
    *ngIf="showModalDataManagedNeo4jEditor"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedNeo4jEditorClosed)="handleCloseDataManagedNeo4jEditor($event)">Load Managed Neo4j Editor ...
</data-managedNeo4jEditor>


<!-- Modal: Data Managed Overlay Editor -->
<data-managedOverlayEditor
    *ngIf="showModalDataManagedOverlayEditor"
    [selectedDatasource]="selectedDatasource"
    (formDataManagedOverlayEditorClosed)="handleCloseDataManagedOverlayEditor($event)">Load Managed Overlay Editor ...
</data-managedOverlayEditor>


<data-transformation
    *ngIf="showModalDataTransformation"
    [selectedDatasource]="selectedDatasource"
    (formDataTransformationClosed)="handleCloseDataTransformation($event)">Load Transformation ...
</data-transformation>


<!-- Modal: Data Edit Datasource -->
<data-editDatasource
    *ngIf="showModalDataEditDatasource"
    (formDataEditDatasourceClosed)="handleCloseDataEditDatasource($event)">Load Data Edit Datasource ...
</data-editDatasource>


<!-- Modal: Datasource Overview -->
<data-datasourceOverview
    *ngIf="showModalDataOverview"
    (formDataDatasourceOverviewClosed)="handleCloseDataDatasourceOverview($event)">Load Datasource Overview ...
</data-datasourceOverview>


<!-- Modal: Data Combination Append -->
<data-combination-append
    *ngIf="showModalCombinationAppend"
    (formDataCombinationAppendClosed)="handleCloseDataCombinationAppend($event)">Load Data Combination Append ...
</data-combination-append>


<!-- Modal: Datasource Usage -->
<data-datasourceUsage
    *ngIf="showModalDataUsage"
    (formDataDatasourceUsageClosed)="handleCloseDataDatasourceUsage($event)">Load Datasource Usage ...
</data-datasourceUsage>


<!-- Modal: Datasource Schedule Edit -->
<data-datasourceScheduleEdit
    *ngIf="showModalDataScheduleEdit"
    (formDataDatasourceScheduleEditClosed)="handleCloseDataDatasourceScheduleEdit($event)">Load Datasource Schedule Edit ...
</data-datasourceScheduleEdit>


<!-- Modal: Datasource Schedule -->
<data-datasourceSchedule
    *ngIf="showModalDataSchedule"
    (formDataDatasourceScheduleClosed)="handleCloseDataDatasourceSchedule($event)">Load Datasource Schedule ...
</data-datasourceSchedule>


<!-- Modal: Datasource Refresh Once -->
<data-refresh-once
    *ngIf="showModalDataRefreshOnce"
    (formDataRefreshOnceClosed)="handleCloseDataDatasourceRefreshOnce($event)">Load Datasource Refresh Once ...
</data-refresh-once>


<!-- Modal: Datasource Refresh Repeatedly -->
<data-refresh-repeat
    *ngIf="showModalDataRefreshRepeat"
    (formDataRefreshRepeatClosed)="handleCloseDataDatasourceRefreshRepeat($event)">Load Datasource Refresh Repeatedly ...
</data-refresh-repeat>


<!-- Modal: data  -->
<data
    *ngIf="showModalData"
    (formDataPopupClosed)="handleCloseData($event)">Load Data ...
</data>


<!-- Modal: data DataQuality -->
<data-managed-dataQuality
    *ngIf="showModalManagedDataDataQuality"
    (formDataManagedDataQualityClosed)="handleCloseDataManagedDataQuality($event)">Load Data DataQuality ...
</data-managed-dataQuality>


<!-- Modal: data DataOwnership -->
<data-managed-dataOwnership
    *ngIf="showModalManagedDataOwnership"
    (formDataManagedDataOwnershipClosed)="handleCloseDataManagedDataOwnership($event)">Load Data DataOwnership ...
</data-managed-dataOwnership>


<!-- Modal: data BussGlossary -->
<data-managed-busGlossary
    *ngIf="showModalManageBussGlossary"
    (formDataManagedBusGlossaryClosed)="handleCloseDataManagedBusGlossary($event)">Load Data BussGlossary ...
</data-managed-busGlossary>


<!-- Modal: data DataDictionary -->
<data-managed-dataDictionary
    *ngIf="showModalManagedDataDataDictionary"
    (formDataManagedDataDictionaryClosed)="handleCloseDataManagedDataDictionary($event)">Load Data DataDictionary ...
</data-managed-dataDictionary>


<!-- Modal: data Combinations for Join/Minus/Intersect -->
<data-combination
    *ngIf="showModalDataCombination"
    [combinationType]="combinationType"
    (formDataCombinationClosed)="handleCloseDataCombination($event)">Load Data Combinations for Join/Minus/Intersect ...
</data-combination>


<!-- Modal: data Share -->
<data-share
    *ngIf="showModalDataShare"
    (formDataShareClosed)="handleCloseDataShare($event)">Share / Permission of a Data Source ...
</data-share>


<!-- Modal: Business Glossary -->
<data-business-glossary
    *ngIf="showModalBusinessGlossary"
    (formDataBusinessGlossaryClosed)="handleCloseBusinessGlossary($event)">Business Glossary for Data Source ...
</data-business-glossary>


<!-- Modal: data Dictionary -->
<data-dictionary
    *ngIf="showModalDataDictionary"
    (formDataDictionaryClosed)="handleCloseDataDictionary($event)">Dictionary of a Data Source ...
</data-dictionary>


<!-- Modal: data Summary -->
<data-summary
    *ngIf="showModalDataSummary"
    (formDataSummaryClosed)="handleCloseDataSummary($event)">Summary of a Data Source ...
</data-summary>


<!-- Modal: Data Delete Datasource -->
<data-deleteDatasource
    *ngIf="showModalDataDeleteDatasource"
    (formDataDeleteDatasourceClosed)="handleCloseDataDeleteDatasource($event)">Load Data Delete Datasource ...
</data-deleteDatasource>



<!-- Modal: Widget Expand -->
<widget-expand
    class="formPopupDashboard"
    *ngIf="showModalWidgetExpand"
    [selectWidgetIndex]="selectWidgetIndex"
    [selectDatasetID]="selectDatasetID"
    [selectDatasourceID]="selectDatasourceID"
    (formWidgetExpandClosed)="handleCloseWidgetExpand($event)">Load Widget Expand ...
</widget-expand>


<!-- Modal: Widget Export -->
<widget-export
    class="formPopupDashboard"
    *ngIf="showModalWidgetExport"
    [selectedWidget]="selectedWidget"
    (formWidgetExportClosed)="handleCloseWidgetExport($event)">Load Widget Export ...
</widget-export>


<!-- Modal: Widget Delete -->
<widget-delete
    class="formPopupDashboard"
    *ngIf="showModalWidgetDelete"
    [selectedWidget]="selectedWidget"
    (formWidgetDeleteClosed)="handleCloseWidgetDelete($event)">Load Widget Delete ...
</widget-delete>


<!-- Modal: widget editor -->
<widget-editor
    *ngIf="showModalWidgetEditor"
    [showDatasourcePopup]="showDatasourcePopup"
    [newWidget]="newWidget"
    [canSave]="canSave"
    [selectedWidget]="selectedWidget"
    [newWidgetContainerLeft]="newWidgetContainerLeft"
    [newWidgetContainerTop]="newWidgetContainerTop"
    (formWidgetEditorClosed)="handleCloseWidgetEditor($event)">Load Widget Editor ...
</widget-editor>

<div class="widgetFullScreen" *ngIf="showWidgetFullScreen"
    [style.border]="showWidgetFullScreenBorder"
    [style.height.%]="showWidgetFullScreenHeight"
    [style.width.%]="showWidgetFullScreenWidth"
    >
    <div class="widgetFullScreenClose"
        (click)="clickCloseFullScreen()"
        >
        {{ showWidgetFullScreenX }}
    </div>
    <button class="btn btn-link widgetFullScreenButton"
        type="button"
        (click)="actionmenuWidgetCopyImage()"
        >
        {{ showWidgetFullScreenCopy }}
    </button>
    <div class="widgetFullScreenGraph" #widgetFullDOM></div>
</div>


<!-- Modal: Widget Container -->
<widget-container
    *ngIf="showModalWidgetContainer"
    [selectedWidget]="selectedWidget"
    (formWidgetContainerClosed)="handleCloseWidgetContainer($event)">Widget Container ...
</widget-container>


<!-- Modal: widget checkpoints -->
<widget-checkpoints
    *ngIf="showModalWidgetCheckpoints"
    [selectedWidget]="selectedWidget"
    (formWidgetCheckpointsClosed)="handleCloseWidgetCheckpoints($event)">Load Widget Checkpoints ...
</widget-checkpoints>


<!-- Modal: Widget Hyperlinks -->
<widget-hyperlinks
    *ngIf="showModalWidgetHyperlinks"
    [selectedWidget]="selectedWidget"
    (formWidgetHyperlinksClosed)="handleCloseWidgetLinks($event)">Load Widget Hyperlinks ...
</widget-hyperlinks>


<!-- Modal: Widget Refresh -->
<widget-refresh
    *ngIf="showModalWidgetRefresh"
    [selectedWidget]="selectedWidget"
    (formWidgetRefreshClosed)="handleCloseWidgetRefresh($event)">Load Widget Refresh ...
</widget-refresh>


<!-- Modal: Slicers -->
<slicer-editor
    *ngIf="showModalSlicerEditor"
    [selectedWidget]="selectedWidget"
    [newWidget]="newWidget"
    (formDataSlicersClosed)="handleCloseDataSlicers($event)">Load Slicers ...
</slicer-editor>


<!-- Modal: Widget Tablist -->
<widget-tablist
    *ngIf="showModalWidgetTablist"
    [currentWidgetDashboardTabIDs]="currentWidgetDashboardTabIDs"
    (formWidgetTablistClosed)="handleCloseWidgetTablist($event)">Load Widget Tablist ...
</widget-tablist>


<!-- Modal: Widget Description -->
<widget-description
    *ngIf="showModalWidgetDescription"
    [selectedWidget]="selectedWidget"
    (formWidgetDescriptionClosed)="handleCloseWidgetDescription($event)">Load Widget Description ...
</widget-description>


<!-- Modal: Slicer Delete -->
<slicer-delete
    class="formPopupDashboard"
    *ngIf="showModalSlicerDelete"
    [currentSlicerSpec]="currentSlicerSpec"
    (formSlicerDeleteClosed)="handleCloseSlicerDelete($event)">Load Slicer Delete ...
</slicer-delete>


<!-- Modal: Table editor -->
<table-editor
    *ngIf="showModalTableEditor"
    [showDatasourcePopup]="showDatasourcePopup"
    [newWidget]="newWidget"
    [selectedWidget]="selectedWidget"
    (formWidgetEditorClosed)="handleCloseTableEditor($event)">Load Table Editor ...
</table-editor>


<!-- Modal: Table Delete -->
<table-delete
    class="formPopupDashboard"
    *ngIf="showModalTableDelete"
    [currentTableSpec]="currentTableSpec"
    (formTableDeleteClosed)="handleCloseTableDelete($event)">Load Table Delete ...
</table-delete>


<!-- Modal: Shape Edit -->
<shape-edit
    class="formPopupDashboard"
    *ngIf="showModalShapeEdit"
    [newWidget]="newWidget"
    [selectedWidget]="selectedWidget"
    (formShapeEditClosed)="handleCloseShapeEdit($event)">Load Shape Edit ...
</shape-edit>


<!-- Modal: Shape Delete -->
<shape-delete
    class="formPopupDashboard"
    *ngIf="showModalShapeDelete"
    [selectedWidget]="selectedWidget"
    (formShapeDeleteClosed)="handleCloseShapeDelete($event)">Load Shape Delete ...
</shape-delete>


<!-- Modal: Shape Delete ALL -->
<shape-deleteAll
    class="formPopupDashboard"
    *ngIf="showModalShapeDeleteAll"
    (formShapeDeleteClosedAll)="handleCloseShapeDeleteAll($event)">Load Shape Delete ALL ...
</shape-deleteAll>


<!-- Overlay: Help -->
<dashboard-help
    *ngIf="isFirstTimeUser"
    (formDashboardHelpClosed)="handleCloseDashboardHelp($event)">Load Help form ...
    >
</dashboard-help>


<!-- Modal: Login -->
<login
    class="formPopupDashboard"
    *ngIf="showModalDashboardLogin"
    (formUserLoginClosed)="handleCloseUserLogin($event)">Load Login ...
</login>


<!-- Modal: Palette Button Bar -->
<palette-buttonbar
    *ngIf="showModalUserPaletteButtonBar"
    (formUserWidgetButtonBarClosed)="handleCloseUserPaletteButtonBar($event)">
    Load Palette Button Bar ...
</palette-buttonbar>


<!-- Modal: Users -->
<users
    *ngIf="showModalUsers"
    (formDashboardUsersClosed)="handleCloseUsers($event)">
    Load Users ...
</users>


<!-- Modal: Groups -->
<groups
    *ngIf="showModalGroups"
    (formDashboardGroupsClosed)="handleCloseGroups($event)">
    Load Groups ...
</groups>


<!-- Modal: System Settings -->
<systemsettings
    class="formPopupDashboard"
    *ngIf="showModalUserSystemSettings"
    (formDashboardSystemSettingsClosed)="handleCloseUserSystemSettings($event)">
    Load System Settings ...
</systemsettings>


<!-- Modal: Logout -->
<logout
    class="formPopupDashboard"
    *ngIf="showModalDashboardLogout"
    (formUserLogoutClosed)="handleCloseUserLogout($event)">Load Logout ...
</logout>


<!-- Modal: My Profile -->
<myprofile
    class="formPopupDashboard"
    *ngIf="showModalUserMyProfile"
    [selectedDashboard]="selectedDashboard"
    (formDashboardMyProfileClosed)="handleCloseUserdMyProfile($event)">Load My Profile ...
</myprofile>


<!-- Modal: Preferences -->
<preferences
    class="formPopupDashboard"
    *ngIf="showModalUserPreferences"
    (formDashboardPreferencesClosed)="handleCloseUserPreferences($event)">Load Preferences ...
</preferences>


<!-- Modal: My Permissions -->
<mypermissions
    class="formPopupDashboard"
    *ngIf="showModalUserMyPermissions"
    (formDashboardMyPermissionsClosed)="handleCloseUserMyPermissions($event)">Load My Permissions ...
</mypermissions>


<!-- Modal: AuditTrail -->
<collaborate-audittrail
    class="formPopupDashboard"
    *ngIf="showModalCollaborateAuditTrail"
    (formCollaborateAuditTrailClosed)="handleCloseCollaborateAuditTrail($event)">Load AuditTrail ...
</collaborate-audittrail>


<!-- Modal: Messages -->
<collaborate-messages
    class="formPopupDashboard"
    *ngIf="showModalCollaborateMessages"
    (formCollaborateMessagesClosed)="handleCloseCollaborateMessages($event)">Load Messages ...
</collaborate-messages>


<!-- Modal: Task Add -->
<collaborate-taskadd
    class="formPopupDashboard"
    *ngIf="showModalCollaborateTasksNew"
    (formCollaborateTaskAddClosed)="handleCloseCollaborateTaskAdd($event)">Load Task Add ...
</collaborate-taskadd>


<!-- Modal: System Messages -->
<collaborate-system-messages
    class="formPopupDashboard"
    *ngIf="showModalCollaborateSystemMessages"
    (formCollaborateSystemMessagesClosed)="handleCloseCollaborateSystemMessages($event)">Load System Messages ...
</collaborate-system-messages>


<!-- Modal: Tasks -->
<collaborate-tasks
    class="formPopupDashboard"
    *ngIf="showModalCollaborateTasks"
    (formCollaborateTasksClosed)="handleCloseCollaborateTasks($event)">Load Tasks ...
</collaborate-tasks>


<!-- Modal: Send Message -->
<collaborate-sendmessage
    class="formPopupDashboard"
    *ngIf="showModalCollaborateSendMessage"
    (formDashboardSendMessage)="handleCloseSendMessageAdd($event)"
    [messageAction]="'send'"
    [existingMessagge]=null
    >
    Send Message ...
</collaborate-sendmessage>


<!-- Modal: Add Email -->
<collaborate-sendemail
    class="formPopupDashboard"
    *ngIf="showModalCollaborateSendEmail"
    (formDashboardSendEmailClosed)="handleCloseSendEmailAdd($event)"
    >
    Add Email ...
</collaborate-sendemail>










<!-- ****************************  TESTING & FOOLING AROUND ***************************** -->




