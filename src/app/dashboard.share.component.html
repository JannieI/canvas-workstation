<div class="modal modalBox">
    <div class="modal-dialog modal-xl" role="dialog" aria-hidden="true">
        <div class="modal-content modalContent">

            <button type="button" class="closeButton" (click)="clickClose()">
                X
            </button>

            <div class="gridOverall">
                <div class="gridTitle">
                    <b>Share Dashboard</b>
                </div>
                <div class="gridSubTitle">
                    <i>
                        Indicate who can access this Dashboard, and how.  The options are Private
                        (only accesable to myself), Public (all users can view and edit it) or
                        Access List (list of users and groups shown below, each with 
                        View/Edit/Delete permissions.  To change existing permissions, double click the
                        View/Edit/Delete cell in the grid below.
                    </i>
                </div>

                <div class="gridCurrentTitle">
                    Dashboard Access Type:
                </div>
                <div class="gridCurrentSelect">
                    <div class="select">
                        <select [(ngModel)]="accessType"
                            >
                            <option>Private</option>
                            <option>Public</option>
                            <option>Access List</option>
                        </select>
                    </div>
                </div>
                <div class="gridCurrentButton">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="clickSave()"
                        >
                        Save and Close
                    </button>
                </div>
                <div class="gridNewError" *ngIf="errorMessage != ''">
                    {{ errorMessage }}
                </div>
                <div class="gridCurrentBR" *ngIf="accessType != 'Access List'">
                </div>

                <div class="gridNewTitle" *ngIf="accessType == 'Access List'">
                    <b>For an Access List, you can add a new user or group to the table below.
                       Then toggle the required access by double clicking on it in the table.</b>
                </div>
                <div class="gridNewUserID" *ngIf="accessType == 'Access List'">
                    <b>UserID:</b>
                    <input type="text" [(ngModel)]="userID" placeholder="User ID">
                </div>
                <div class="gridNewGroupName" *ngIf="accessType == 'Access List'">
                    <b>Group:</b>
                </div>
                <div class="gridNewGroupSelect" *ngIf="accessType == 'Access List'">
                    <div class="select">
                        <select id="selects_3"
                            (change)="clickSelectGroup($event)"
                            >
                            <option *ngFor="let row of groups; let i = index">
                                {{ row.name }}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="gridNewButton" *ngIf="accessType == 'Access List'">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="clickAdd()"
                        >
                        Add
                    </button>
                </div>
    
                <div class="gridTable" *ngIf="accessType == 'Access List'">
                    <clr-datagrid>
                        <clr-dg-column
                        [style.text-align]="center">Remove</clr-dg-column>
                        <clr-dg-column [clrDgField]="userID">User ID (single)</clr-dg-column>
                        <clr-dg-column [clrDgField]="name">Group Name (applies to all its members)</clr-dg-column>
                        <clr-dg-column [clrDgField]="canView" class="checkCell">View</clr-dg-column>
                        <clr-dg-column [clrDgField]="canEdit">Edit</clr-dg-column>
                        <clr-dg-column [clrDgField]="canDelete">Delete</clr-dg-column>

                        <clr-dg-row *clrDgItems="let row of dashboardPermissions;
                            let i = index"
                            >
                            <clr-dg-cell>
                                <clr-icon shape="trash"
                                    size="16"
                                    (click)="clickDelete(i, row.id)"
                                    >
                                </clr-icon>
                            </clr-dg-cell>
                            <clr-dg-cell>{{row.userID}}</clr-dg-cell>
                            <clr-dg-cell>{{row.groupName}}</clr-dg-cell>
                            <clr-dg-cell class="checkCell">
                                <clr-icon shape="check" *ngIf="row.canView"
                                    size="16"
                                    (dblclick)="clickToggleView(row.id, i, $event)"
                                    >
                                </clr-icon>
                                <clr-icon shape="times" *ngIf="!row.canView"
                                    size="16"
                                    (dblclick)="clickToggleView(row.id, i, $event)"
                                    >
                                </clr-icon>
                            </clr-dg-cell>
                            <clr-dg-cell class="checkCell">
                                    <clr-icon shape="check" *ngIf="row.canEdit"
                                    size="16"
                                    (click)="clickToggleEdit(row.id, i, $event)"
                                    >
                                </clr-icon>
                                <clr-icon shape="times" *ngIf="!row.canEdit"
                                    size="16"
                                    (click)="clickToggleEdit(row.id, i, $event)"
                                    >
                                </clr-icon>
                            </clr-dg-cell>
                            <clr-dg-cell class="checkCell">
                                    <clr-icon shape="check" *ngIf="row.canDelete"
                                    size="16"
                                    (click)="clickToggleDelete(row.id, i, $event)"
                                    >
                                </clr-icon>
                                <clr-icon shape="times" *ngIf="!row.canDelete"
                                    size="16"
                                    (click)="clickToggleDelete(row.id, i, $event)"
                                    >
                                </clr-icon>
                            </clr-dg-cell>
                        </clr-dg-row>

                    </clr-datagrid>
                </div>
            </div>
        </div>
    </div>
</div>
