<div class="modal modalBox">
    <div class="modal-dialog modal-xl" role="dialog" aria-hidden="true">
        <div class="modal-content   ">
            <div modalContent>
                <button type="button" class="closeButton" (click)="clickClose()">
                    X
                </button>
                <div class="gridOverall">
                    <div *ngIf="!isFirstTimeData" class="gridTitleContainer">
                        <div class="titleCurrent">
                            Current Dataset: <b>{{ currentDataset }}</b>
                            <span *ngIf="currentDataset===''" class="titleFirsttimeMessage">
                                (Click Identify, then click Add)
                            </span>
                        </div>
                        <div class="titleIdentify titleBox">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowIdentifyFile()"
                                [style.background-color]="showIdentifyFile ? 'rgb(211, 211, 247)' : 'transparent'"
                                >
                                1. Identify
                            </button>
                        </div>
                        <div class="titleChevron1a">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowTransform()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titleChevron1b">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowTransform()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titleTransform titleBox">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowTransform()"
                                [style.background-color]="showTransform ? 'rgb(211, 211, 247)' : 'transparent'"
                                >
                                2. Transform
                            </button>
                        </div>
                        <div class="titleChevron2a">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowPivot()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titleChevron2b">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowPivot()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titlePivot titleBox">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowPivot()"
                                [style.background-color]="showPivot ? 'rgb(211, 211, 247)' : 'transparent'"
                                >
                                3. Pivot
                            </button>
                        </div>
                        <div class="titleChevron3a">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowView()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titleChevron3b">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowView()"
                                >
                                >>
                            </button>
                        </div>
                        <div class="titleView titleBox">
                            <button
                                type="button"
                                class="btn btn-link titleButton"
                                (click)="clickShowView()"
                                [style.background-color]="showView ? 'rgb(211, 211, 247)' : 'transparent'"
                                >
                                4. View
                            </button>
                        </div>

                    </div>

                    <div class="gridIdentifyData" *ngIf="showIdentifyFile">
                        <div class="gridIdentifyDataExisting">
                                <span class="gridHeading">Existing Datasets</span>
                            <clr-datagrid class="fieldsDataGrid">
                                <clr-dg-column [clrDgField]="'filterDataset'">Name</clr-dg-column>

                                <clr-dg-row
                                    *ngFor="let row of currentDatasources"
                                    (click)="clickDatasourceRow(row.name)"
                                    >
                                    <clr-dg-cell>{{row.name}}</clr-dg-cell>
                                </clr-dg-row>
                            </clr-datagrid>
                        </div>
                        <div class="gridIdentifyDataIDfile">
                            <span>Please enter file name and location, or
                                <button
                                    type="button"
                                    class="btn btn-link"
                                    (click)="clickFileBrowse()"
                                    >
                                    Browse
                                </button>
                                :
                            </span>
                            <input type="text" id="formFields_7"
                                placeholder="Folder/FileName"
                                class="selectFile"
                                >
                            <br>
                            Worksheet:
                            <span class="select">
                                <select id="selects_3" class="selectBox">
                                    <option>New York</option>
                                    <option>San Francisco</option>
                                    <option>Austin</option>
                                    <option>Paris</option>
                                    <option>Seattle</option>
                                </select>
                            </span>
                            <br>
                            Name of Dataset:
                            <input type="text" id="formFields_7" placeholder="Dataset Name">
                            <button
                                type="button"
                                class="btn btn-link selectButon"
                                (click)="clickFileAdd('Preview')"
                                >
                                Preview
                            </button>
                            <div class="checkbox-inline">
                                <input type="checkbox" id="checkrads_5">
                                <label for="checkrads_5">Transpose rows and cols: </label>
                            </div>
                            <div></div>
                            <button
                                type="button"
                                class="btn btn-secondary selectButon"
                                (click)="clickFileAdd('Add')"
                                >
                                Add
                            </button>
                            <button
                                type="button"
                                class="btn btn-secondary selectButon"
                                (click)="clickFileAdd('AddAndClose')"
                                >
                                Add and Close
                            </button>
                            <button
                                type="button"
                                class="btn btn-secondary selectButon"
                                (click)="clickClose(true)"
                                >
                                Close
                            </button>
                        </div>
                        <div class="gridIdentifyDataPreview">

                                <!-- [style.width.px]="sideNavWidth"
                                [style.min-width.rem]="sideNavMinWidth" -->

                            <div *ngIf="showDataPreview">
                                <clr-datagrid class="fieldsDataGrid">
                                        

                                    <clr-dg-column *ngFor="let row of dataFieldNames">{{row}}</clr-dg-column>
                                    <clr-dg-row *ngFor="let row of currentData">
                                        
                                        <clr-dg-cell *ngFor="let col of dataFieldNames; let i = index">
                                                {{ row[col] }}
                                        </clr-dg-cell>
                                    </clr-dg-row>

                                    <!-- <clr-dg-footer>
                                        {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}} rows
                                        <clr-dg-pagination #pagination [clrDgPageSize]="pageSize"></clr-dg-pagination>
                                    </clr-dg-footer> -->
                                    
                                    <clr-dg-footer>
                                        {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
                                        of {{pagination.totalItems}} rows
                                        <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                                    </clr-dg-footer>                                    

                                </clr-datagrid>
                            </div>
                        </div>
                    </div>

                    <div class="gridTransform" *ngIf="showTransform">
                        <div class="gridTransformTransformations">

                            <span class="gridHeading">Added Transformations </span>
                            <clr-datagrid class="fieldsDataGrid">
                                <clr-dg-column [clrDgField]="'filterTransformation'">Name</clr-dg-column>

                                <clr-dg-row *ngFor="let row of currentTransformations">
                                    <clr-dg-cell>{{row.name}}</clr-dg-cell>
                                </clr-dg-row>
                            </clr-datagrid>

                        </div>
                        <div class="gridTransformNew">
                            <div>Please select a fields and the transformation that must be 
                                applied to it:
                            </div>
                            <label for="selects_2">Field:</label>
                            <div class="select">
                                <select id="selects_2">
                                    <option *ngFor="let row of dataFieldNames">
                                        {{ row }}
                                    </option>
                                </select>
                            </div>
                            <label for="selects_1">Transformation:</label>
                            <div class="select">
                                <select id="selects_1">
                                    <option *ngFor="let row of transformationsFormat">
                                            {{ row.name }}
                                        </option>
                                    </select>
                            </div>
                            <div>
                                <input type="text" id="formFields_7"
                                    placeholder="Description of transformation ..."
                                    class="selectFile"
                                    >
                            </div>
                            <button
                                type="button"
                                class="btn btn-secondary selectButon"
                                (click)="clickFileAddTransformation()"
                                >
                                Add
                            </button>
                            <br>
                            <br>
                            Optionally save these transformations as a Transformation-Set for later use:
                            <input type="text" id="formFields_7"
                                placeholder="Set Name"
                                class="selectFile"
                                >
                            <button
                                type="button"
                                class="btn btn-link selectButon"
                                (click)="clickFileAddTransformation()"
                                >
                                Save
                            </button>
                        </div>
                        <div class="gridTransformExisting">
                            <div *ngIf="showTransformDetail">
                                <input type="text" id="formFields_7"
                                    placeholder="Enter date format"
                                    class="selectFile"
                                    >

                            </div>
                        </div>
                    </div>

                    <div class="gridPivot" *ngIf="showPivot">
                        <div class="gridPivotFields">
                            Existing Field

                            <clr-datagrid class="fieldsDataGrid">
                                <clr-dg-column [clrDgField]="'filterPivotFields'">Name</clr-dg-column>
                                <!-- <clr-dg-column [clrDgField]="'filterPivotFields'">Type</clr-dg-column> -->
                                <!-- <clr-dg-column [clrDgField]="'filterPivotFields'">Edit?</clr-dg-column> -->
                                <clr-dg-row *ngFor="let row of dataFieldNames">
                                    <clr-dg-cell
                                        id="fld"
                                        draggable="true"
                                        (dragstart)="dragstart_handler($event)"
                                        (dragend)="dragend_handler($event)"
                                        (drop)="drop_handler($event);" 
                                        (dragover)="dragover_handler($event);"
                                            >
                                        {{ row }}
                                    </clr-dg-cell>
                                    <!-- <clr-dg-cell>
                                        <span class="color-square" 
                                        [style.backgroundColor]="'blue'">.</span>
                                    </clr-dg-cell> -->

                                    <!-- <clr-dg-cell>
                                        <div [hidden]="isEditMode">
                                            {{row.name}}
                                            <input #input type="number" min="0" 
                                            [(value)]="changeVar" 
                                            (change)="changedInput(value)" />
                                        </div>
                                        <div [hidden]="!isEditMode">
                                            <input #input type="number" min="0" 
                                            [(value)]="changeVar" 
                                            (change)="changedInput(value)" />
                                        </div>
                                    </clr-dg-cell> -->

                                </clr-dg-row>

                            </clr-datagrid>

                        </div>
                        <div class="gridPivotDropArea">
                            <div>
                                Please drop a Field onto a Row, Column and the Aggregate. 
                                Then select the type of aggregation and Refresh.
                            </div>
                            <div>
                                Row Fields:
                                <div class="pivotDropField"
                                    id="rowFld"
                                    (drop)="drop_handler($event);" 
                                    (dragover)="dragover_handler($event);"
                                    draggable="true"
                                    (dragstart)="dragstart_handler($event)"
                                    (dragend)="dragend_handler($event)"
                                    >
                                    {{ rowField }}
                                </div>
                            </div>
                            <div
                                draggable="true"
                                (dragstart)="dragstart_handler($event)"
                                (dragend)="dragend_handler($event)"
                                >
                                Column Fields:
                                <div class="pivotDropField"
                                    id="colFld"
                                    (drop)="drop_handlerCol($event);" 
                                    (dragover)="dragover_handler($event);"
                                    draggable="true"
                                    (dragstart)="dragstart_handler($event)"
                                    (dragend)="dragend_handler($event)"
                                    >
                                    {{ colField }}
                                </div>
                            </div>
                            <div>
                                Aggregation:
                                <div class="select">
                                    <select id="selects_1">
                                        <option>Sum</option>
                                        <option>Average</option>
                                        <option>Minimum</option>
                                        <option>Maximum</option>
                                        <option>Mean</option>
                                    </select>
                                </div>
                                <div
                                    class="gridPivotAggregateField"
                                    draggable="true"
                                    (dragstart)="dragstart_handler($event)"
                                    (dragend)="dragend_handler($event)"
                                    >
                                    Aggregate Field:
                                    <div class="pivotDropAggregate">

                                    </div>
                                </div>
                            </div>
                            <div>       
                                <input type="checkbox" id="checkrads_1">
                                <label for="checkrads_1">Always-Refresh</label>
                                <button
                                    type="button"
                                    class="btn btn-secondary"
                                    (click)="clickRefreshPivot()"
                                    >
                                    Refresh
                                </button>
                            </div>

                        </div>
                        <div class="gridPivotResult">
                            <b>Result
                            </b>
                            {{ pivotData }}
                        </div>
                    </div>

                    <div class="gridView" *ngIf="showView">
                        <div class="gridViewSide">
                            Summary, etc @ Top
                        </div>
                        <div class="gridViewRight">
                            <div *ngIf="gridViewFieldProperties" class="propertyBox">
                                <div class="propertyLine">
                                    Info for field
                                    <b>
                                        <div class="select">
                                            <select id="selects_3">
                                                <option>TradeDate</option>
                                                <option>TraderName</option>
                                                <option>ValueTraded</option>
                                                <option>Volume</option>
                                            </select>
                                        </div>
                                    </b>
                                </div>
                                <div class="propertyLine">
                                    Description: bla-bla-bla
                                </div>
                                <div class="propertyLine">
                                    Local Name: <input type="text" id="formFields_7" placeholder="Enter Name">
                                </div>
                                <div class="propertyLine">
                                    Type: <b>Number</b>  Change to:
                                    <div class="select">
                                        <select id="selects_3">
                                            <option>Boolean (true/false)</option>
                                            <option>Date (2014/07/31)</option>
                                            <option>DateTime (2014/07/31 12:41:04)</option>
                                            <option>String ('May West')</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="propertyLine">
                                    Format: <b></b>  Change to:
                                    <div class="select">
                                        <select id="selects_3">
                                            <option>Number</option>
                                            <option>Monetary</option>
                                            <option>YYYY/MM/DD</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="propertyLine">
                                    Filter: <b></b>  Change to: <input type="text" id="formFields_7" placeholder="Filter text">
                                </div>
                                <div class="propertyLine">
                                    Calculation: <b></b>  Change to: <input type="text" id="formFields_7" placeholder="Enter Formula">
                                </div>
                                <div class="propertyLine">
                                    Order: <b></b>  Change to: <input type="text" id="formFields_7" placeholder="Order (1 Asc)">
                                </div>
                                <div class="propertyLine">
                                    Hide: <b></b>  Change to:
                                    <div class="select">
                                        <select id="selects_3">
                                            <option>True</option>
                                            <option>False</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="propertyLine">
                                    Key Field: <b></b>  Change to:
                                    <div class="select">
                                        <select id="selects_3">
                                            <option>True</option>
                                            <option>False</option>
                                        </select>
                                    </div>
                                </div>
                            </div>     
                            <div *ngIf="gridViewExplain">                               
                                ExplainedBy:
                                <div class="propertyLine">
                                    Explained by: <input type="text" id="formFields_7"
                                    placeholder="BarChart of Value by TradeDate">
                                </div>
                            </div>
                            <div *ngIf="gridViewSummaryGraphs">
                                
                                <button
                                    type="button"
                                    class="btn btn-secondary"
                                    (click)="clickRefreshSummary()"
                                    >
                                    Refresh Summary
                                </button>

                                <br> <br>

                                Nr records: <b>241</b>
                                <br>
                                3-9 graphs that summarises the data
                                <br> <br>
                                <i>
                                    * IF key fields have been marked, some cardinality / summary
                                    graphs will be shown to the shape of the data, bins,
                                    frequency distribution, etc to help understand the data.
                                    If no fields were marked, the software will makes its
                                    best guess.
                                </i>
                            </div>
                            <div *ngIf="gridViewDataQuality">
                                
                                Data Quality notes: describes issues with the quality of the data,
                                and what will be done about it by whom and when.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



                <!-- Check Browswer capabilities:
                if (Modernizr.draganddrop) {
                    // Browser supports HTML5 DnD.
                } else {
                    // Fallback to a library solution.
                }     -->

                <!-- cursor: move gives users a visual indicator that something is moveable:
                -->

                <!-- <clr-dg-footer>
                        {{pagination1.firstItem + 1}} - {{pagination1.lastItem + 1}} of     {{pagination1.totalItems}} Nodes
                        <clr-dg-pagination #pagination1 [clrDgPageSize]="5"></clr-dg-pagination>
                </clr-dg-footer> -->
                <!-- clrDgColumnSizeChange clrDgColumnResize -->



                <!-- <ng-container>
                        <clr-dg-row *ngFor="let destination of walkingDistance.destinationHeader; let i=index">
                            <clr-dg-cell>{{destination.name}}</clr-dg-cell>
                            <clr-dg-cell *ngFor="let d of walkingDistance.depotZoneHeader; let j=index">
                                <div [hidden]="isEditMode">
                                    {{walkingDistance.walkingDistanceMatrix[i][j]}}
                                </div>
                                <div [hidden]="!isEditMode">
                                    <input #input type="number" min="0" [value]="walkingDistance.walkingDistanceMatrix[i][j]" (change)="setWalkingDistance(i, j, input.value)" />
                                </div>
                            </clr-dg-cell>
                        </clr-dg-row>
                    </ng-container>
                
                    <clr-dg-footer></clr-dg-footer>
                
                </clr-datagrid> -->


                <!-- So in your case, when switching from read-only to inline edit and vice-versa, 
                you'd just call datagrid.resize() after the change and the columns should 
                resize accordingly. I hope this helps. -->


                <!-- If I add 'overflow' and 'text-overflow' properties to '.datagrid-cell' in 
                _datagrid.clarity.scss then I can get the cell to look proper, but making 
                similar change to '.datagrid-column' or '.datagrid-column-title' make the 
                column resize handle disappear during times when it overflows.
                
                    .datagrid-cell {
                        flex: 1 1 auto;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        &.datagrid-fixed-width {
                            flex: 0 0 auto;
                        }
                    } -->


                    <!-- <clr-dg-column [clrDgField]="'ruleName'">Name</clr-dg-column> -->

