<div class="modal modalBox">
	<div class="modal-dialog modal-xl" role="dialog" aria-hidden="true">
		<div class="modal-content modalContent">


            <div class="gridOverall">
                <button type="button" class="closeButton" (click)="clickClose()">
                    <b>X</b>
                </button>

                <div class="gridTitle">
                    <b>Widget Editor</b>
                    <clr-signpost>
                        <clr-icon shape="info-circle"
                            clrSignpostTrigger>
                        </clr-icon>
                        <clr-signpost-content *clrIfOpen
                            [clrPosition]="'bottom-middle'">
                            <h5 style="margin-top: 0; color:gray;">
                                Help
                            </h5>
                            <p style="margin-top: 0; color:gray;">
                                <b>For new Widgets:</b> select a datasource, and click Continue 
                                to the Widget Editor.
                                <b>Widget Editor:</b> drag a Field onto the X and Y coloured blocks.
                                Select a graph type.  Properties can be changed by clicking the dropdown
                                icons.  Click Save to show the Widget on the Dashboard, or click Cancel
                                to return to the Dashboard.
                                Click the X or press Escape to close this form.
                            </p>
                        </clr-signpost-content>
                    </clr-signpost>
                </div>

                <!-- SHOWS the DS info to select one -->
                <div class="datasourceMain" *ngIf="showDatasourceMain">

                    <div class="datasourceMainHelp">
                        Select a <b>Datasources</b> on which a Widget must be created.  Details
                        about the datasource is shown on the right:
                    </div>  

                    <div class="datasourceMainDescriptionTitle">
                        <b>Description:</b>
                    </div>                        
                    <div class="datasourceMainDescription">
                        {{ selectedDescription }}
                    </div>

                    <div class="datasourceMainError">
                        {{ errorMessage }}
                    </div>

                    <div class="datasourceMainListTitle">
                        <b>Datasources:</b>
                    </div>
                    <div class="datasourceMainList">
                        <nav
                            >
                            <div>
                                <clr-datagrid class="datagrid-compact">
                                    <clr-dg-column clrDgField="name"  
                                        [(clrDgSortOrder)]="sortOrder"
                                        (click)="sortOrder=sortOrder * -1"
                                        >
                                        Name
                                    </clr-dg-column>
                                    
                                    <clr-dg-row *clrDgItems="let row of localDatasources; let i = index"
                                        [clrDgItem]="row"
                                        [style.background-color]="(i == selectedRowIndex)? '#123456' : 'white'"
                                        [style.color]="(i == selectedRowIndex)? 'white' : 'gray'"
                                        (click)="clickDSrow(i, row.id)"
                                        >
                                        <clr-dg-cell>
                                            {{ row.name }}
                                            <span class="badge badge-5">#{{row.nrWidgets}}</span>
                                        </clr-dg-cell>
                                    </clr-dg-row>

                                </clr-datagrid>
                            </div>
                        </nav>
                    </div>

                    <div class="datasourceMainPreviewTitle">
                        <b>Preview:</b>
                    </div>
                    <div class="datasourceMainPreview" *ngIf="hasClicked">
                        <clr-datagrid class="datagrid-compact">

                            <clr-dg-column *ngFor="let row of dataFieldNames">{{row}}</clr-dg-column>
                            <clr-dg-row *ngFor="let row of currentData">

                                <clr-dg-cell *ngFor="let col of dataFieldNames; 
                                    let i = index"
                                    >
                                    {{ row[col] }}
                                </clr-dg-cell>
                            </clr-dg-row>

                        </clr-datagrid>
                    </div>

                    <div class="datasourceMainButton">
                        <button *ngIf="hasClicked"
                            class="btn btn-sm btn-secondary datasourceButton"
                            (click)="clickContinue()">
                            Continue
                        </button>
                    </div>
                </div>

                <!-- Widget Editor -->
                <div class="editorMain" *ngIf="!showDatasourceMain">

                </div>

            </div>

        </div>
    </div>
</div>