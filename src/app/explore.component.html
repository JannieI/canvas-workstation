<div class="presentationButton dropdown" *ngIf="presentation">
    <clr-dropdown>
        <button type="button" clrDropdownTrigger>
            <clr-icon shape="bars"></clr-icon>
        </button>

        <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
            <button
                type="button"
                class="btn btn-link btn-sm"
                clrDropdownItem
                title="Show the first Dashboard in the presentation"
                >
                <clr-icon shape="step-forward down" size="20"></clr-icon>
                First Dashboard
            </button>
            <button
                type="button"
                class="btn btn-secondary btn-sm"
                clrDropdownItem
                title="Jump to the Next Dashboard"
                >
                <clr-icon shape="fast-forward" size="20"></clr-icon>
                Next Dashboard
            </button>
            <button
                type="button"
                class="btn btn-secondary btn-sm"
                clrDropdownItem
                title="Return to the Previous Dashboard"
                >
                <clr-icon shape="rewind" size="20"></clr-icon>
                Previous Dashboard
            </button>
            <button
                type="button"
                class="btn btn-secondary btn-sm"
                clrDropdownItem
                title="Show the Last Dashboard in the presentation"
                >
                <clr-icon shape="step-forward" size="20"></clr-icon>
                Last Dashboard
            </button>
            <button
                type="button"
                class="btn btn-secondary btn-sm"
                clrDropdownItem
                title="Print all the Dashboards in presentation format"
                >
                <clr-icon shape="printer" size="20"></clr-icon>
                Print ...
            </button>
            <button
                type="button"
                class="btn btn-secondary btn-sm"
                clrDropdownItem
                (click)="clickClosePresentation()"
                title="Exit the presentation, and return to the Dashboard page"
                >
                <clr-icon shape="times" size="20"></clr-icon>
                Exit
            </button>
        </clr-dropdown-menu>
    </clr-dropdown>
</div>


<!-- Overlay: Dashboard Help -->
<dashboard-help
    *ngIf="isFirstTimeDashboard"
    (formDashboardHelpClosed)="handleCloseDashboardHelp($event)">Load Help form ...
    >
</dashboard-help>


<!-- Overlay: Dashboard Help for Presentation -->
<dashboard-helpPresentation
    *ngIf="isFirstTimePresentation  &&  presentation"
    (formDashboardHelpPresentationClosed)="handleCloseDashboardHelpPresentation($event)">Load Help form ...
    >
</dashboard-helpPresentation>


<span
    class="graphy"
    [style.color] = "showContainerHeader ? 'black' : 'transparent'"
    (click)="clickWidget($event)"
    (dragstart)="dragStartWidget($event)"
    (dragend)="dragEndWidget($event)"
    draggable="true"
    #dragWidget

    >
    <span class="widgetHandle"
    [style.color] = "showContainerHeader ? 'black' : 'transparent'"
    >Drag Edit</span>
    <div
        [style.border] = "showContainerHeader ? '1px black dotted' : 'none'"
        >
        <span #visReal>
        </span>
    </div>
</span>

<div>
    <div *ngFor="let ds of localDashboards" class="widgetContainer"
        #widgetContainter>
        <div class="widgetButtonBar">
            <clr-icon shape="plus" size="20" class="buttonBarIcon" (click)="clickWidgetEdit()"></clr-icon>
            <clr-icon shape="filter-grid" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="cursor-hand" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pop-out" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pencil" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pin" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="copy" size="20" class="buttonBarIcon"></clr-icon>
        </div>
        <div class="widget">
            <div #widget>
            </div>
        </div>
    </div>
</div>

<!-- Working one - LEAVE !!! -->
<div *ngIf="showShapes">
    <div *ngFor="let row of localShapes" class="shapeContainer"
        #shapeContainter>
        <div class="widgetButtonBar">
            <clr-icon shape="plus" size="20" class="buttonBarIcon" (click)="clickWidgetEdit()"></clr-icon>
            <clr-icon shape="filter-grid" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="cursor-hand" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pop-out" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pencil" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="pin" size="20" class="buttonBarIcon"></clr-icon>
            <clr-icon shape="copy" size="20" class="buttonBarIcon"></clr-icon>
        </div>
        <div class="shape">
            <div #shape>
                {{ row.type }}
                <div
                    #dragCircle
                    class="aCircle"
                    (dragstart)="dragStartCircle($event)"
                    (dragend)="dragEndCircle($event)"
                    draggable="true"
                    >
                    <svg height="100" width="100" >
                        <circle #circle [attr.cx]="50"
                        [attr.cy]="50" [attr.r]="circleRadius" [attr.stroke]="blue"
                        [attr.stroke-width]="2" [style.fill]="none" />
                    </svg>
                </div>
            </div>
        </div>
    </div>
</div>





<!-- Eksperimental! -->
<div *ngFor="let row of localShapes; let i = index" class="shapeContainer2"
    [style.background-color]="row.containerBackgroundColor"
    [style.border]="row.isSelected? '2px solid red' : row.isSelected"
    [style.box-shadow]="row.containerBoxshadow"
    [style.height.px]="row.containerHeight"
    [style.left.px]="row.containerLeft"
    [style.top.px]="row.containerTop"
    [style.width.px]="row.containerWidth"
    [style.zindex]="row.containerZindex"
    #shapeContainter2>
    <div class="widgetButtonBar2">
        <clr-icon
            shape="link"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetLinks(i)"
            title="Show Links"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="copy"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetDuplicate(i)"
            title="Duplicate this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="deploy"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuArrangeBack(i)"
            title="Move Widget back"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="block"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuArrangeFront(i)"
            title="Move Widget forward"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="trash"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetDelete(i)"
            title="Delete this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="cursor-arrow"
            size="20"
            class="buttonBarIcon"
            (click)="clickSelect(i)"
            title="Select this Widget"
            >
        </clr-icon>
    </div>


    <div class="shape2"
        [style.zindex]="row.containerZindex"
        >
        <div
            #dragCircle
            class="aCircle2"
            (dragstart)="dragStartCircle($event)"
            (dragend)="dragEndCircle($event)"
            draggable="true"
            [style.zindex]="row.containerZindex"
            >
            <svg 
                height="100" 
                width="100" >
                <circle #circle2 
                    [style.cx]="row.cx"
                    [style.cy]="row.cy" 
                    [style.r]="row.r" 
                    [attr.stroke]="row.stroke"
                    [attr.stroke-width]="3" 
                    [attr.fill]="row.fill" 
                    [style.zindex]="row.containerZindex"
                />
            </svg>
        </div>
    </div>
</div>

<div class="statusBar" *ngIf="showMainMenu">
    <span class="statusBarText statusBarTextBorder" title="Current Dashboard"
        (click)="clickDashboardDescription()">
        Analysis of Value Traded 2017 ...
    </span>

    <span class="statusBarText statusBarTextBorder" title="Click to show Tab List"
        (click)="clickListTabs()">
        Tabs :
    </span>
    <span class="statusBarText statusBarTextBorder" title="Click to show first Tab">
        <clr-icon shape="angle-double left" size="12"
            (click)="clickShowFirstTab()"></clr-icon>
    </span>
    <span class="statusBarText statusBarTextBorder" title="Click to show previous Tab">
        <clr-icon shape="angle left" size="12"
            (click)="clickShowPreviousTab()"></clr-icon>
    </span>

    <span class="statusBarText statusBarTextBorder" title="Current Tab"
        (click)="clickShowNextTab()">
        <b>{{ currentTabName }}</b>
    </span>
    <span class="statusBarText statusBarTextBorder" (click)="clickShowNextTab()" title="Click to show next Tab ">
        <clr-icon shape="angle right" size="12"></clr-icon>
    </span>
    <span class="statusBarText statusBarTextBorder" (click)="clickShowLastTab()" title="Click show last Tab">
        <clr-icon shape="angle-double right" size="12"></clr-icon>
    </span>

    <span class="statusBarText statusBarTextBorder" title="Click to Add a new Tab">
        <clr-icon shape="plus" size="12"
            (click)="clickAddTab()"></clr-icon>
    </span>

    <span class="statusBarText" title="How long ago the Dashboard layout was updated">
        Updated: 1d
    </span>
    <span class="statusBarText" title="When last all the data in the Dashboard was refresh">
        Refreshed: 08:31
    </span>
    <span [ngSwitch]="editMode" class="statusBarText">
        <b    *ngSwitchCase="true" title="Changes can be done in Edit Mode">Edit Mode </b>
        <span *ngSwitchDefault title="View only mode means no changes can be made">View-Only     </span>
    </span>
    <span class="statusBarText" title="Indicate long-running queries in the background">
        {{ statusBarRunning }}
    </span>
    <span class="statusBarText statusBarTextBorder" title="Click to cancel a running query">
        {{ statusBarCancelRefresh }}
    </span>
    <span class="statusBarText" title="Short message.  If more than one, it will indicate the last one">
      {{ statusBarMessages }}
    </span>
    <span class="statusBarText" title="Working standalone (local) or logged into a server">
      Local/Srv
    </span>
    <span class="statusBarText" title="All changes have been saved, or are being saved...">
      Saving.../Saved
    </span>
    <span class="statusBarText" title="Canvas version">
      V 1.02
    </span>
    <span 
        class="statusBarText" 
        title="Indicates if a Template is being used (which is readonly)"
        (click)="clickStatusTemplate()"
        >
      {{ templateInUse }} 
    </span>
</div>


<!-- <div class="bgGrid" *ngIf="showGrid">
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
    <div>
        <h1>.</h1>
    </div>
</div> -->

<div class="bgGrid" *ngIf="showGrid">
    <svg width="100%" height="100%" class="bgGridSvg">

        <!-- Create mask that we'll use to define a slight gradient -->
        <mask maskUnits="userSpaceOnUse" id="fade" class="bgGridSvg">
            <!-- Here's that slight gradient -->
            <linearGradient id="gradient" x1="0" y1="0" x2="0" y2="100%" class="bgGridSvg">
                <stop offset ="0" style="stop-color: #FFFFFF" />
                <stop offset ="1" style="stop-color: #000000" />
            </linearGradient>
            <!-- The canvas for our mask -->
            <rect fill="url(#gradient)" width="100%" height="100%" class="bgGridSvg" />
        </mask>

        <!-- Let's define the pattern -->
        <!-- The width and height should be double the circle radius we plan to use -->
        <pattern id="pattern-circles" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse" class="bgGridSvg">
            <!-- Now let's draw the circle -->
            <!-- We're going to define the `fill` in the CSS for flexible use -->
            <circle mask="url(#fade)" cx="1" cy="1" r="1" class="bgGridSvg" />
        </pattern>
        <!-- The canvas with our applied pattern -->
        <rect x="0" y="0" width="100%" height="100%" fill="url(#pattern-circles)" class="bgGridSvg" />

    </svg>
</div>

<!-- Modal: New Tab -->
<dashboard-tab
    class="formPopupDashboard"
    *ngIf="showNewTab"
    (formDashboardTabClosed)="handleCloseDashboardTab($event)">Load Dashboard Tab ...
</dashboard-tab>





<!-- Testing new Widget stuffies -->
<div *ngFor="let row of localWidgets; let i = index" class="widgetContainer2"
    #widgetContainter2
    [style.background-color]="row.containerBackgroundColor"
    [style.border]="row.isSelected? '2px solid red' : row.containerBorder"
    [style.box-shadow]="row.containerBoxshadow"
    [style.height.px]="row.containerHeight"
    [style.left.px]="row.containerLeft"
    [style.top.px]="row.containerTop"
    [style.width.px]="row.containerWidth"
    [style.zindex]="row.containerZindex"
    >
    <div class="widgetButtonBar2">
        <clr-icon
            shape="pencil"
            size="20"
            class="buttonBarIcon"
            (click)="clickWidgetEdit(i)"
            title="Edit Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation"
            shape="pop-out"
            size="20"
            class="buttonBarIcon"
            (click)="clickWidgetCheckpoints(i)"
            title="Show Checkpoints"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation"
            shape="note"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetNotes(i)"
            title="Show Notes"
            >
        </clr-icon>
        <clr-icon
            shape="link"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetLinks(i)"
            title="Show Links"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation"
            shape="refresh"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetRefresh(i)"
            title="Refresh Dataset for this Widget only"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="copy"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetDuplicate(i)"
            title="Duplicate this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation"
            shape="pop-out"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetExpand(i)"
            title="Expand the Dataset for this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation"
            shape="export"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetExport(i)"
            title="Export the Dataset for this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="deploy"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuArrangeBack(i)"
            title="Move Widget back"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="block"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuArrangeFront(i)"
            title="Move Widget forward"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="trash"
            size="20"
            class="buttonBarIcon"
            (click)="clickMenuWidgetDelete(i)"
            title="Delete this Widget"
            >
        </clr-icon>
        <clr-icon *ngIf="!presentation  &&  hasDatasources"
            shape="cursor-arrow"
            size="20"
            class="buttonBarIcon"
            (click)="clickSelect(i)"
            title="Select this Widget"
            >
        </clr-icon>
    </div>

    <div class="widgetSelectedDrag" *ngIf="row.isSelected"
        (mousedown)="clickDragMouseDown($event, i)"
        (mouseup)="clickDragMouseUp($event, i)"
        (dragstart)="clickDragStart($event, i)"
        (dragend)="clickDragEnd($event, i)"
        (keydown)="clickDragKeydown($event, i)"
        >
        <clr-icon
            shape="cursor-hand"
            size="20"
            class="buttonBarIcon2"
            title="Drag handle to move Widget around"
            draggable="true"
            >
        </clr-icon>
    </div>

    <span class="widgetSelectedResize" *ngIf="row.isSelected"
        (mousedown)="clickResizeMouseDown($event, i)"
        (mouseup)="clickResizeMouseUp($event, i)"
        (dragstart)="clickResizeStart($event, i)"
        (dragend)="clickResizeEnd($event, i)"
        (keydown)="clickResizeKeydown($event, i)"
        >
        <clr-icon class="widgetSelectedResize"
            shape="resize left"
            size="20"
            class="buttonBarIcon2"
            title="Resize handle to change Widget container size"
            draggable="true"
            >
        </clr-icon>
    </span>

    <div class="widget"
        [style.height.px]="row.containerHeight - 35"
        [style.width.px]="row.containerWidth"
        #widget2
        >
        {{ row.id }}
    </div>
</div>


<!-- Modal: widget editor -->
<widget-editor
    *ngIf="showModalWidgetEditor"
    [currentWidgetSpec]="currentWidgetSpec"
    (formWidgetEditorClosed)="handleCloseWidgetEditor($event)">Load Widget Editor ...
</widget-editor>


<!-- Dummy Slicer -->
<div class="slicer">
    <section class="form-block" title="Filter the Budget dataset on Make of Car">
        <div class="slicerLabel"><b>Filter: Make</b></div>
        <div class="form-group">
            <div class="select multiple">
                <select id="selects_5" multiple>
                    <option>Volvo</option>
                    <option>Kia</option>
                    <option>Honda</option>
                    <option>Jeep</option>
                    <option>BMW</option>
                </select>
            </div>
        </div>
    </section>
</div>

<div class="tabList" *ngIf="showTabList">
    <div class="tabListItem" (click)="showTabList=!showTabList">Summary</div>
    <div class="tabListItem" (click)="showTabList=!showTabList">Budget</div>
    <div class="tabListItem" (click)="showTabList=!showTabList">Europe</div>
    <div class="tabListItem" (click)="showTabList=!showTabList">Headcount</div>
</div>


<div class="dashboardDescription" *ngIf="showDashboardDescription">
    <div> This Dashboard is a Summary of bla-bla-bla ...</div>
    <button
        type="button"
        class="btn btn-link"
        (click)="showDashboardDescription=!showDashboardDescription"
        >
        Close
    </button>

</div>



